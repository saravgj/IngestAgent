2025-07-16 11:16:02,476 - IngestAgent - INFO - Ensured watch folder exists: ./ingest_source
2025-07-16 11:16:02,476 - IngestAgent - INFO - Ensured output folder exists: ./ingest_processed
2025-07-16 11:16:02,477 - IngestAgent - INFO - Ingest Agent initialized.
2025-07-16 11:16:02,477 - IngestAgent - DEBUG - Configuration loaded: {
  "watch_folders": [
    "./ingest_source"
  ],
  "output_folder": "./ingest_processed",
  "policies": {
    "min_duration_seconds": 10,
    "max_duration_seconds": 3600,
    "allowed_formats": [
      "mp4",
      "mov",
      "mxf"
    ],
    "required_metadata_fields": [
      "title",
      "genre",
      "language"
    ],
    "ad_duration_limit_seconds": 60,
    "max_file_size_mb": 40960
  },
  "log_level": "DEBUG",
  "log_file": "ingest_agent.log"
}
2025-07-16 11:16:02,477 - IngestAgent - INFO - Ingest Agent instance fully initialized and ready with OpenTelemetry tracer.
2025-07-16 11:16:04,652 - IngestAgent - INFO - --- Starting ingestion pipeline for: ./ingest_source/my_episode_s01e01.mp4 ---
2025-07-16 11:16:04,653 - IngestAgent - DEBUG - Thought Chain: Pipeline started for ./ingest_source/my_episode_s01e01.mp4.
2025-07-16 11:16:04,653 - IngestAgent - DEBUG - Thought Chain: Loaded initial metadata from sidecar for override checks.
2025-07-16 11:16:04,655 - IngestAgent - DEBUG - Thought Chain: Executing Format Detection & Validation step.
2025-07-16 11:16:04,657 - IngestAgent - INFO - Starting format detection for: ./ingest_source/my_episode_s01e01.mp4
2025-07-16 11:16:04,657 - IngestAgent - DEBUG - Thought Chain: Initiating FFprobe simulation for ./ingest_source/my_episode_s01e01.mp4
2025-07-16 11:16:04,658 - IngestAgent - DEBUG - Simulated FFprobe for ./ingest_source/my_episode_s01e01.mp4: {'format': {'filename': 'my_episode_s01e01.mp4', 'nb_streams': 2, 'format_name': 'mp4', 'duration': 12.0, 'size': 20971520}, 'streams': [{'codec_type': 'video', 'codec_name': 'h264', 'width': 1920, 'height': 1080, 'avg_frame_rate': '25/1', 'display_aspect_ratio': '16:9'}, {'codec_type': 'audio', 'codec_name': 'aac', 'channels': 2}]}
2025-07-16 11:16:04,670 - IngestAgent - DEBUG - Thought Chain: File extension 'mp4' is allowed. Justification: Complies with 'allowed_formats' policy.
2025-07-16 11:16:04,671 - IngestAgent - DEBUG - Thought Chain: No operator override for transcode detected. Justification: Proceeding with standard transcode decision.
2025-07-16 11:16:04,671 - IngestAgent - INFO - Format validation successful for ./ingest_source/my_episode_s01e01.mp4.
2025-07-16 11:16:04,671 - IngestAgent - DEBUG - Thought Chain: Decision - Format is compliant. No transcode needed. Justification: All format policies passed.
2025-07-16 11:16:04,674 - IngestAgent - INFO - Format validation successful for ./ingest_source/my_episode_s01e01.mp4.
2025-07-16 11:16:04,675 - IngestAgent - DEBUG - Thought Chain: Executing Metadata Extraction & Enrichment step.
2025-07-16 11:16:04,675 - IngestAgent - INFO - Starting metadata extraction for: ./ingest_source/my_episode_s01e01.mp4
2025-07-16 11:16:04,676 - IngestAgent - DEBUG - Thought Chain: Initiating metadata extraction and enrichment for ./ingest_source/my_episode_s01e01.mp4
2025-07-16 11:16:04,934 - IngestAgent - DEBUG - Calculated sha256 checksum for ./ingest_source/my_episode_s01e01.mp4
2025-07-16 11:16:04,935 - IngestAgent - DEBUG - Thought Chain: Basic metadata extracted from file system and FFprobe data.
2025-07-16 11:16:04,936 - IngestAgent - INFO - Extracted metadata from sidecar: ./ingest_source/my_episode_s01e01.json
2025-07-16 11:16:04,936 - IngestAgent - DEBUG - Thought Chain: Sidecar JSON found and merged. Justification: External metadata source provided.
2025-07-16 11:16:04,937 - IngestAgent - DEBUG - Thought Chain: Title already present in metadata. Justification: Existing metadata takes precedence.
2025-07-16 11:16:04,937 - IngestAgent - DEBUG - Thought Chain: Determining asset type for my_episode_s01e01.mp4
2025-07-16 11:16:04,937 - IngestAgent - DEBUG - Thought Chain: Determined asset type: episode.
2025-07-16 11:16:04,938 - IngestAgent - INFO - Determined asset type: episode
2025-07-16 11:16:04,941 - IngestAgent - INFO - Performing real AI enrichment for asset type: episode
2025-07-16 11:16:04,942 - IngestAgent - DEBUG - Thought Chain: Starting AI enrichment. Initial metadata: My First Episode, type: episode
2025-07-16 11:16:04,949 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI summary based on prompt: 'Generate a very short, concise summary (max 2 sentences) for a media a...'
2025-07-16 11:16:04,953 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:06,218 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:06,219 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI summary. Justification: LLM provided concise overview based on title/genre.
2025-07-16 11:16:06,221 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI keywords based on prompt: 'Extract up to 5 keywords from the following media asset description: '...'
2025-07-16 11:16:06,221 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:07,239 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:07,240 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI keywords. Justification: LLM provided relevant keywords in expected format.
2025-07-16 11:16:07,241 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI mood based on prompt: 'Based on the genre 'Sci-Fi' and summary 'In this sci-fi debut, we see ...'
2025-07-16 11:16:07,249 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:08,152 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:08,154 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI mood. Justification: LLM provided a single-word mood based on context.
2025-07-16 11:16:08,155 - IngestAgent - DEBUG - Real AI enrichment complete. New metadata: {'source_file': 'my_episode_s01e01.mp4', 'ingest_timestamp': '2025-07-16T11:16:04.676235', 'checksum_sha256': '3e872f2c5008f32b024a9cb02112280e7ef9e2f1bb54a417f685dd96537fa504', 'file_size_bytes': 20971520, 'duration': 12.0, 'title': 'My First Episode', 'genre': 'Sci-Fi', 'language': 'English', 'ei_rating': 'E', 'asset_type': 'episode', 'ai_summary': 'In this sci-fi debut, we see characters navigating futuristic settings and confronting unknown technologies. The episode introduces the primary conflict and establishes the visual style of the series.\n', 'ai_keywords': ['sci-fi', 'futuristic', 'technology', 'conflict', 'visual style'], 'mood': 'serious'}
2025-07-16 11:16:08,155 - IngestAgent - DEBUG - Thought Chain: AI enrichment process concluded.
2025-07-16 11:16:08,156 - IngestAgent - INFO - Metadata extraction and enrichment complete for ./ingest_source/my_episode_s01e01.mp4.
2025-07-16 11:16:08,156 - IngestAgent - DEBUG - Thought Chain: Metadata extraction and enrichment process concluded.
2025-07-16 11:16:08,156 - IngestAgent - DEBUG - Final metadata: {
  "source_file": "my_episode_s01e01.mp4",
  "ingest_timestamp": "2025-07-16T11:16:04.676235",
  "checksum_sha256": "3e872f2c5008f32b024a9cb02112280e7ef9e2f1bb54a417f685dd96537fa504",
  "file_size_bytes": 20971520,
  "duration": 12.0,
  "title": "My First Episode",
  "genre": "Sci-Fi",
  "language": "English",
  "ei_rating": "E",
  "asset_type": "episode",
  "ai_summary": "In this sci-fi debut, we see characters navigating futuristic settings and confronting unknown technologies. The episode introduces the primary conflict and establishes the visual style of the series.\n",
  "ai_keywords": [
    "sci-fi",
    "futuristic",
    "technology",
    "conflict",
    "visual style"
  ],
  "mood": "serious"
}
2025-07-16 11:16:08,157 - IngestAgent - DEBUG - Thought Chain: Executing Content Normalization step.
2025-07-16 11:16:08,158 - IngestAgent - INFO - Starting content normalization for: my_episode_s01e01.mp4
2025-07-16 11:16:08,158 - IngestAgent - DEBUG - Thought Chain: Initiating content normalization for my_episode_s01e01.mp4
2025-07-16 11:16:08,158 - IngestAgent - DEBUG - Thought Chain: Determined normalized name: asset_b3d3b477_my_first_episode.mp4. Justification: Standard naming convention applied.
2025-07-16 11:16:08,158 - IngestAgent - INFO - Normalized and moved my_episode_s01e01.mp4 to ./ingest_processed/asset_b3d3b477_my_first_episode.mp4
2025-07-16 11:16:08,159 - IngestAgent - DEBUG - Thought Chain: File successfully moved to normalized path. Justification: Unique content, moved to standard location. Adding checksum to processed set.
2025-07-16 11:16:08,159 - IngestAgent - INFO - Content normalization complete for ./ingest_source/my_episode_s01e01.mp4.
2025-07-16 11:16:08,159 - IngestAgent - DEBUG - Thought Chain: Content normalization process concluded.
2025-07-16 11:16:08,159 - IngestAgent - DEBUG - Thought Chain: Executing Policy Compliance Check step.
2025-07-16 11:16:08,160 - IngestAgent - INFO - Starting policy compliance check for asset: My First Episode
2025-07-16 11:16:08,160 - IngestAgent - DEBUG - Thought Chain: Initiating policy compliance check.
2025-07-16 11:16:08,160 - IngestAgent - DEBUG - Thought Chain: Required field 'title' is present. Justification: Metadata completeness criteria met for this field.
2025-07-16 11:16:08,160 - IngestAgent - DEBUG - Thought Chain: Required field 'genre' is present. Justification: Metadata completeness criteria met for this field.
2025-07-16 11:16:08,160 - IngestAgent - DEBUG - Thought Chain: Required field 'language' is present. Justification: Metadata completeness criteria met for this field.
2025-07-16 11:16:08,160 - IngestAgent - DEBUG - Thought Chain: Checking duration policy. Duration: 12.00s, Asset Type: episode
2025-07-16 11:16:08,161 - IngestAgent - DEBUG - Thought Chain: Checking file size policy. Size: 20.00 MB, Max: 40960 MB.
2025-07-16 11:16:08,161 - IngestAgent - DEBUG - Thought Chain: File size is within allowed limits. Justification: Complies with file size policy.
2025-07-16 11:16:08,161 - IngestAgent - DEBUG - Thought Chain: Checking E/I rating for kids content.
2025-07-16 11:16:08,162 - IngestAgent - INFO - Policy compliance check passed for My First Episode.
2025-07-16 11:16:08,163 - IngestAgent - DEBUG - Thought Chain: Decision - Policy compliance passed. Status: PASS. Justification: All policy checks passed without flags.
2025-07-16 11:16:08,163 - IngestAgent - DEBUG - Thought Chain: Policy compliance check concluded.
2025-07-16 11:16:08,163 - IngestAgent - DEBUG - Thought Chain: Executing Event-Driven Hand-off step.
2025-07-16 11:16:08,164 - IngestAgent - INFO - Handing off asset to downstream agents: N/A
2025-07-16 11:16:08,164 - IngestAgent - DEBUG - Thought Chain: Initiating hand-off process.
2025-07-16 11:16:08,164 - IngestAgent - INFO - Context Shared (simulated hand-off):
{
  "original_path": "./ingest_source/my_episode_s01e01.mp4",
  "ingest_start_time": "2025-07-16T11:16:04.652205",
  "status": "COMPLETED",
  "format_valid": true,
  "format_issues": [],
  "transcode_needed": false,
  "initial_transcode_required": false,
  "ffprobe_data": {
    "format": {
      "filename": "my_episode_s01e01.mp4",
      "nb_streams": 2,
      "format_name": "mp4",
      "duration": 12.0,
      "size": 20971520
    },
    "streams": [
      {
        "codec_type": "video",
        "codec_name": "h264",
        "width": 1920,
        "height": 1080,
        "avg_frame_rate": "25/1",
        "display_aspect_ratio": "16:9"
      },
      {
        "codec_type": "audio",
        "codec_name": "aac",
        "channels": 2
      }
    ]
  },
  "metadata": {
    "source_file": "my_episode_s01e01.mp4",
    "ingest_timestamp": "2025-07-16T11:16:04.676235",
    "checksum_sha256": "3e872f2c5008f32b024a9cb02112280e7ef9e2f1bb54a417f685dd96537fa504",
    "file_size_bytes": 20971520,
    "duration": 12.0,
    "title": "My First Episode",
    "genre": "Sci-Fi",
    "language": "English",
    "ei_rating": "E",
    "asset_type": "episode",
    "ai_summary": "In this sci-fi debut, we see characters navigating futuristic settings and confronting unknown technologies. The episode introduces the primary conflict and establishes the visual style of the series.\n",
    "ai_keywords": [
      "sci-fi",
      "futuristic",
      "technology",
      "conflict",
      "visual style"
    ],
    "mood": "serious",
    "normalized_file_path": "./ingest_processed/asset_b3d3b477_my_first_episode.mp4",
    "normalized_file_name": "asset_b3d3b477_my_first_episode.mp4",
    "compliance_status": "PASS",
    "compliance_flags": [],
    "escalate_to_human": false
  },
  "normalized_file_path": "./ingest_processed/asset_b3d3b477_my_first_episode.mp4",
  "ingest_end_time": "2025-07-16T11:16:08.163720"
}
2025-07-16 11:16:08,166 - IngestAgent - DEBUG - Thought Chain: Hand-off completed successfully. Justification: Asset is compliant or issues were handled internally.
2025-07-16 11:16:08,166 - IngestAgent - INFO - Hand-off complete.
2025-07-16 11:16:08,167 - IngestAgent - INFO - --- Ingestion pipeline completed for: ./ingest_source/my_episode_s01e01.mp4 ---
2025-07-16 11:16:08,167 - IngestAgent - DEBUG - Thought Chain: Pipeline completed successfully for ./ingest_source/my_episode_s01e01.mp4.
2025-07-16 11:16:08,871 - IngestAgent - INFO - --- Starting ingestion pipeline for: ./ingest_source/bad_format_video.avi ---
2025-07-16 11:16:08,871 - IngestAgent - DEBUG - Thought Chain: Pipeline started for ./ingest_source/bad_format_video.avi.
2025-07-16 11:16:08,871 - IngestAgent - INFO - No initial sidecar JSON found for ./ingest_source/bad_format_video.avi.
2025-07-16 11:16:08,871 - IngestAgent - DEBUG - Thought Chain: Executing Format Detection & Validation step.
2025-07-16 11:16:08,872 - IngestAgent - INFO - Starting format detection for: ./ingest_source/bad_format_video.avi
2025-07-16 11:16:08,872 - IngestAgent - DEBUG - Thought Chain: Initiating FFprobe simulation for ./ingest_source/bad_format_video.avi
2025-07-16 11:16:08,872 - IngestAgent - DEBUG - Simulated FFprobe for ./ingest_source/bad_format_video.avi: {'format': {'filename': 'bad_format_video.avi', 'nb_streams': 2, 'format_name': 'avi', 'duration': 0.6, 'size': 1048576}, 'streams': [{'codec_type': 'video', 'codec_name': 'mpeg2video', 'width': 1920, 'height': 1080, 'avg_frame_rate': '25/1', 'display_aspect_ratio': '16:9'}, {'codec_type': 'audio', 'codec_name': 'mp3', 'channels': 2}]}
2025-07-16 11:16:08,874 - IngestAgent - DEBUG - Thought Chain: Format 'avi' is not allowed. Justification: Policy 'allowed_formats' violated. Flagging for transcode.
2025-07-16 11:16:08,874 - IngestAgent - DEBUG - Thought Chain: Video codec 'mpeg2video' is unsupported. Justification: Policy violation. Flagging for transcode.
2025-07-16 11:16:08,874 - IngestAgent - DEBUG - Thought Chain: Audio codec 'mp3' is unsupported. Justification: Policy violation. Flagging for transcode.
2025-07-16 11:16:08,875 - IngestAgent - DEBUG - Thought Chain: No operator override for transcode detected. Justification: Proceeding with standard transcode decision.
2025-07-16 11:16:08,875 - IngestAgent - WARNING - Format non-compliant for ./ingest_source/bad_format_video.avi. Transcode job triggered (simulated). Issues: ['Unsupported file format: avi. Allowed: mp4, mov, mxf', 'Unsupported video codec: mpeg2video.', 'Unsupported audio codec: mp3.']
2025-07-16 11:16:08,875 - IngestAgent - DEBUG - Thought Chain: Decision - Transcode needed due to format issues. Justification: Format issues detected and no override present.
2025-07-16 11:16:08,877 - IngestAgent - INFO - Ingestion for ./ingest_source/bad_format_video.avi completed, but transcode is needed.
2025-07-16 11:16:08,877 - IngestAgent - DEBUG - Thought Chain: Executing Metadata Extraction & Enrichment step.
2025-07-16 11:16:08,878 - IngestAgent - INFO - Starting metadata extraction for: ./ingest_source/bad_format_video.avi
2025-07-16 11:16:08,879 - IngestAgent - DEBUG - Thought Chain: Initiating metadata extraction and enrichment for ./ingest_source/bad_format_video.avi
2025-07-16 11:16:09,044 - IngestAgent - DEBUG - Calculated sha256 checksum for ./ingest_source/bad_format_video.avi
2025-07-16 11:16:09,045 - IngestAgent - DEBUG - Thought Chain: Basic metadata extracted from file system and FFprobe data.
2025-07-16 11:16:09,045 - IngestAgent - INFO - No sidecar JSON found for ./ingest_source/bad_format_video.avi.
2025-07-16 11:16:09,045 - IngestAgent - DEBUG - Thought Chain: No sidecar JSON found. Justification: No external metadata provided. Proceeding without it.
2025-07-16 11:16:09,046 - IngestAgent - DEBUG - Thought Chain: Title not found. Justification: Inferred from filename as per policy.
2025-07-16 11:16:09,046 - IngestAgent - DEBUG - Thought Chain: Determining asset type for bad_format_video.avi
2025-07-16 11:16:09,046 - IngestAgent - DEBUG - Thought Chain: Identified as 'ad' based on filename heuristic.
2025-07-16 11:16:09,046 - IngestAgent - DEBUG - Thought Chain: Determined asset type: ad.
2025-07-16 11:16:09,047 - IngestAgent - INFO - Determined asset type: ad
2025-07-16 11:16:09,047 - IngestAgent - INFO - Performing real AI enrichment for asset type: ad
2025-07-16 11:16:09,048 - IngestAgent - DEBUG - Thought Chain: Starting AI enrichment. Initial metadata: Bad Format Video, type: ad
2025-07-16 11:16:09,048 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI summary based on prompt: 'Generate a very short, concise summary (max 2 sentences) for a media a...'
2025-07-16 11:16:09,049 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:11,223 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:11,225 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI summary. Justification: LLM provided concise overview based on title/genre.
2025-07-16 11:16:11,226 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI keywords based on prompt: 'Extract up to 5 keywords from the following media asset description: '...'
2025-07-16 11:16:11,226 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:12,452 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:12,454 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI keywords. Justification: LLM provided relevant keywords in expected format.
2025-07-16 11:16:12,455 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI mood based on prompt: 'Based on the genre 'N/A' and summary 'This video appears to have techn...'
2025-07-16 11:16:12,455 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:14,503 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:14,504 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI mood. Justification: LLM provided a single-word mood based on context.
2025-07-16 11:16:14,505 - IngestAgent - DEBUG - Real AI enrichment complete. New metadata: {'source_file': 'bad_format_video.avi', 'ingest_timestamp': '2025-07-16T11:16:08.879385', 'checksum_sha256': '4e29ad18ab9f42d7c233500771a39d7c852b200baf328fd00fbbe3fecea1eb56', 'file_size_bytes': 1048576, 'duration': 0.6, 'title': 'Bad Format Video', 'asset_type': 'ad', 'ai_summary': 'This video appears to have technical issues. It may be unplayable or have significant visual or audio problems.\n', 'ai_keywords': ['Bad Format', 'Video', 'technical issues', 'unplayable', 'visual or audio problems'], 'mood': 'frustrating'}
2025-07-16 11:16:14,505 - IngestAgent - DEBUG - Thought Chain: AI enrichment process concluded.
2025-07-16 11:16:14,506 - IngestAgent - INFO - Metadata extraction and enrichment complete for ./ingest_source/bad_format_video.avi.
2025-07-16 11:16:14,506 - IngestAgent - DEBUG - Thought Chain: Metadata extraction and enrichment process concluded.
2025-07-16 11:16:14,506 - IngestAgent - DEBUG - Final metadata: {
  "source_file": "bad_format_video.avi",
  "ingest_timestamp": "2025-07-16T11:16:08.879385",
  "checksum_sha256": "4e29ad18ab9f42d7c233500771a39d7c852b200baf328fd00fbbe3fecea1eb56",
  "file_size_bytes": 1048576,
  "duration": 0.6,
  "title": "Bad Format Video",
  "asset_type": "ad",
  "ai_summary": "This video appears to have technical issues. It may be unplayable or have significant visual or audio problems.\n",
  "ai_keywords": [
    "Bad Format",
    "Video",
    "technical issues",
    "unplayable",
    "visual or audio problems"
  ],
  "mood": "frustrating"
}
2025-07-16 11:16:14,507 - IngestAgent - DEBUG - Thought Chain: Executing Content Normalization step.
2025-07-16 11:16:14,507 - IngestAgent - INFO - Starting content normalization for: bad_format_video.avi
2025-07-16 11:16:14,508 - IngestAgent - DEBUG - Thought Chain: Initiating content normalization for bad_format_video.avi
2025-07-16 11:16:14,508 - IngestAgent - DEBUG - Thought Chain: Determined normalized name: asset_65da0c1c_bad_format_video.avi. Justification: Standard naming convention applied.
2025-07-16 11:16:14,511 - IngestAgent - INFO - Normalized and moved bad_format_video.avi to ./ingest_processed/asset_65da0c1c_bad_format_video.avi
2025-07-16 11:16:14,511 - IngestAgent - DEBUG - Thought Chain: File successfully moved to normalized path. Justification: Unique content, moved to standard location. Adding checksum to processed set.
2025-07-16 11:16:14,512 - IngestAgent - INFO - Content normalization complete for ./ingest_source/bad_format_video.avi.
2025-07-16 11:16:14,512 - IngestAgent - DEBUG - Thought Chain: Content normalization process concluded.
2025-07-16 11:16:14,513 - IngestAgent - DEBUG - Thought Chain: Executing Policy Compliance Check step.
2025-07-16 11:16:14,513 - IngestAgent - INFO - Starting policy compliance check for asset: Bad Format Video
2025-07-16 11:16:14,513 - IngestAgent - DEBUG - Thought Chain: Initiating policy compliance check.
2025-07-16 11:16:14,513 - IngestAgent - DEBUG - Thought Chain: Required field 'title' is present. Justification: Metadata completeness criteria met for this field.
2025-07-16 11:16:14,513 - IngestAgent - DEBUG - Thought Chain: Missing required field 'genre'. Justification: Policy 'required_metadata_fields' violated. Escalation triggered.
2025-07-16 11:16:14,514 - IngestAgent - DEBUG - Thought Chain: Missing required field 'language'. Justification: Policy 'required_metadata_fields' violated. Escalation triggered.
2025-07-16 11:16:14,514 - IngestAgent - DEBUG - Thought Chain: Checking duration policy. Duration: 0.60s, Asset Type: ad
2025-07-16 11:16:14,514 - IngestAgent - DEBUG - Thought Chain: Checking file size policy. Size: 1.00 MB, Max: 40960 MB.
2025-07-16 11:16:14,514 - IngestAgent - DEBUG - Thought Chain: File size is within allowed limits. Justification: Complies with file size policy.
2025-07-16 11:16:14,514 - IngestAgent - DEBUG - Thought Chain: Checking E/I rating for kids content.
2025-07-16 11:16:14,516 - IngestAgent - WARNING - Policy compliance issues for Bad Format Video. Flags: ['Missing required metadata field: genre.', 'Missing required metadata field: language.']
2025-07-16 11:16:14,516 - IngestAgent - DEBUG - Thought Chain: Decision - Policy compliance failed. Status: FAIL. Justification: One or more policy flags were set.
2025-07-16 11:16:14,517 - IngestAgent - ERROR - Escalating asset Bad Format Video to human for review.
2025-07-16 11:16:14,517 - IngestAgent - DEBUG - Thought Chain: Decision - Escalating to human due to critical policy breach. Justification: Escalation flag set by policy check.
2025-07-16 11:16:14,517 - IngestAgent - DEBUG - Thought Chain: Policy compliance check concluded.
2025-07-16 11:16:14,547 - IngestAgent - CRITICAL - Unhandled error in ingestion pipeline for ./ingest_source/bad_format_video.avi: 'compliance_flags'
Traceback (most recent call last):
  File "/Users/admin/PycharmProjects/IngestAgent/ingest_agent.py", line 1085, in ingest_asset_pipeline
    processed_asset_info["compliance_flags"].extend(compliance_flags)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
KeyError: 'compliance_flags'
2025-07-16 11:16:14,553 - IngestAgent - INFO - Handing off asset to downstream agents: N/A
2025-07-16 11:16:14,553 - IngestAgent - DEBUG - Thought Chain: Initiating hand-off process.
2025-07-16 11:16:14,553 - IngestAgent - INFO - Context Shared (simulated hand-off):
{
  "original_path": "./ingest_source/bad_format_video.avi",
  "ingest_start_time": "2025-07-16T11:16:08.870953",
  "status": "CRITICAL_FAILURE",
  "format_valid": false,
  "format_issues": [
    "Unsupported file format: avi. Allowed: mp4, mov, mxf",
    "Unsupported video codec: mpeg2video.",
    "Unsupported audio codec: mp3."
  ],
  "transcode_needed": true,
  "initial_transcode_required": true,
  "ffprobe_data": {
    "format": {
      "filename": "bad_format_video.avi",
      "nb_streams": 2,
      "format_name": "avi",
      "duration": 0.6,
      "size": 1048576
    },
    "streams": [
      {
        "codec_type": "video",
        "codec_name": "mpeg2video",
        "width": 1920,
        "height": 1080,
        "avg_frame_rate": "25/1",
        "display_aspect_ratio": "16:9"
      },
      {
        "codec_type": "audio",
        "codec_name": "mp3",
        "channels": 2
      }
    ]
  },
  "metadata": {
    "source_file": "bad_format_video.avi",
    "ingest_timestamp": "2025-07-16T11:16:08.879385",
    "checksum_sha256": "4e29ad18ab9f42d7c233500771a39d7c852b200baf328fd00fbbe3fecea1eb56",
    "file_size_bytes": 1048576,
    "duration": 0.6,
    "title": "Bad Format Video",
    "asset_type": "ad",
    "ai_summary": "This video appears to have technical issues. It may be unplayable or have significant visual or audio problems.\n",
    "ai_keywords": [
      "Bad Format",
      "Video",
      "technical issues",
      "unplayable",
      "visual or audio problems"
    ],
    "mood": "frustrating",
    "normalized_file_path": "./ingest_processed/asset_65da0c1c_bad_format_video.avi",
    "normalized_file_name": "asset_65da0c1c_bad_format_video.avi",
    "compliance_status": "FAIL",
    "compliance_flags": [
      "Missing required metadata field: genre.",
      "Missing required metadata field: language."
    ],
    "escalate_to_human": true
  },
  "normalized_file_path": "./ingest_processed/asset_65da0c1c_bad_format_video.avi",
  "error_message": "'compliance_flags'",
  "ingest_end_time": "2025-07-16T11:16:14.548632"
}
2025-07-16 11:16:14,555 - IngestAgent - DEBUG - Thought Chain: Hand-off completed successfully. Justification: Asset is compliant or issues were handled internally.
2025-07-16 11:16:14,555 - IngestAgent - INFO - Hand-off complete.
2025-07-16 11:16:15,058 - IngestAgent - INFO - --- Starting ingestion pipeline for: ./ingest_source/long_ad_campaign_x.mp4 ---
2025-07-16 11:16:15,058 - IngestAgent - DEBUG - Thought Chain: Pipeline started for ./ingest_source/long_ad_campaign_x.mp4.
2025-07-16 11:16:15,059 - IngestAgent - DEBUG - Thought Chain: Loaded initial metadata from sidecar for override checks.
2025-07-16 11:16:15,060 - IngestAgent - DEBUG - Thought Chain: Executing Format Detection & Validation step.
2025-07-16 11:16:15,062 - IngestAgent - INFO - Starting format detection for: ./ingest_source/long_ad_campaign_x.mp4
2025-07-16 11:16:15,062 - IngestAgent - DEBUG - Thought Chain: Initiating FFprobe simulation for ./ingest_source/long_ad_campaign_x.mp4
2025-07-16 11:16:15,062 - IngestAgent - DEBUG - Simulated FFprobe for ./ingest_source/long_ad_campaign_x.mp4: {'format': {'filename': 'long_ad_campaign_x.mp4', 'nb_streams': 2, 'format_name': 'mp4', 'duration': 60.6, 'size': 105906176}, 'streams': [{'codec_type': 'video', 'codec_name': 'h264', 'width': 1920, 'height': 1080, 'avg_frame_rate': '25/1', 'display_aspect_ratio': '16:9'}, {'codec_type': 'audio', 'codec_name': 'aac', 'channels': 2}]}
2025-07-16 11:16:15,063 - IngestAgent - DEBUG - Thought Chain: File extension 'mp4' is allowed. Justification: Complies with 'allowed_formats' policy.
2025-07-16 11:16:15,064 - IngestAgent - DEBUG - Thought Chain: No operator override for transcode detected. Justification: Proceeding with standard transcode decision.
2025-07-16 11:16:15,064 - IngestAgent - INFO - Format validation successful for ./ingest_source/long_ad_campaign_x.mp4.
2025-07-16 11:16:15,064 - IngestAgent - DEBUG - Thought Chain: Decision - Format is compliant. No transcode needed. Justification: All format policies passed.
2025-07-16 11:16:15,065 - IngestAgent - INFO - Format validation successful for ./ingest_source/long_ad_campaign_x.mp4.
2025-07-16 11:16:15,065 - IngestAgent - DEBUG - Thought Chain: Executing Metadata Extraction & Enrichment step.
2025-07-16 11:16:15,066 - IngestAgent - INFO - Starting metadata extraction for: ./ingest_source/long_ad_campaign_x.mp4
2025-07-16 11:16:15,066 - IngestAgent - DEBUG - Thought Chain: Initiating metadata extraction and enrichment for ./ingest_source/long_ad_campaign_x.mp4
2025-07-16 11:16:15,514 - IngestAgent - DEBUG - Calculated sha256 checksum for ./ingest_source/long_ad_campaign_x.mp4
2025-07-16 11:16:15,514 - IngestAgent - DEBUG - Thought Chain: Basic metadata extracted from file system and FFprobe data.
2025-07-16 11:16:15,515 - IngestAgent - INFO - Extracted metadata from sidecar: ./ingest_source/long_ad_campaign_x.json
2025-07-16 11:16:15,515 - IngestAgent - DEBUG - Thought Chain: Sidecar JSON found and merged. Justification: External metadata source provided.
2025-07-16 11:16:15,515 - IngestAgent - DEBUG - Thought Chain: Title already present in metadata. Justification: Existing metadata takes precedence.
2025-07-16 11:16:15,516 - IngestAgent - DEBUG - Thought Chain: Determining asset type for long_ad_campaign_x.mp4
2025-07-16 11:16:15,516 - IngestAgent - DEBUG - Thought Chain: Identified as 'ad' based on filename heuristic.
2025-07-16 11:16:15,516 - IngestAgent - DEBUG - Thought Chain: Determined asset type: ad.
2025-07-16 11:16:15,516 - IngestAgent - INFO - Determined asset type: ad
2025-07-16 11:16:15,516 - IngestAgent - INFO - Performing real AI enrichment for asset type: ad
2025-07-16 11:16:15,516 - IngestAgent - DEBUG - Thought Chain: Starting AI enrichment. Initial metadata: Long Ad Campaign X, type: ad
2025-07-16 11:16:15,517 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI summary based on prompt: 'Generate a very short, concise summary (max 2 sentences) for a media a...'
2025-07-16 11:16:15,517 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:16,688 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:16,691 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI summary. Justification: LLM provided concise overview based on title/genre.
2025-07-16 11:16:16,693 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI keywords based on prompt: 'Extract up to 5 keywords from the following media asset description: '...'
2025-07-16 11:16:16,693 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:18,810 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:18,812 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI keywords. Justification: LLM provided relevant keywords in expected format.
2025-07-16 11:16:18,812 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI mood based on prompt: 'Based on the genre 'Commercial' and summary '"Long Ad Campaign X" is a...'
2025-07-16 11:16:18,813 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:20,851 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:20,853 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI mood. Justification: LLM provided a single-word mood based on context.
2025-07-16 11:16:20,854 - IngestAgent - DEBUG - Real AI enrichment complete. New metadata: {'source_file': 'long_ad_campaign_x.mp4', 'ingest_timestamp': '2025-07-16T11:16:15.066748', 'checksum_sha256': '3c195a0507198c7574551ae014247153b20bac784cf0a5c3b1fa5038c2900093', 'file_size_bytes': 105906176, 'duration': 60.6, 'title': 'Long Ad Campaign X', 'genre': 'Commercial', 'language': 'English', 'asset_type': 'ad', 'ai_summary': '"Long Ad Campaign X" is a commercial. It presents a series of connected advertisements, presumably for a single product or brand.\n', 'ai_keywords': ['Long Ad Campaign X', 'commercial', 'advertisements', 'product', 'brand'], 'mood': 'promotional'}
2025-07-16 11:16:20,854 - IngestAgent - DEBUG - Thought Chain: AI enrichment process concluded.
2025-07-16 11:16:20,855 - IngestAgent - INFO - Metadata extraction and enrichment complete for ./ingest_source/long_ad_campaign_x.mp4.
2025-07-16 11:16:20,856 - IngestAgent - DEBUG - Thought Chain: Metadata extraction and enrichment process concluded.
2025-07-16 11:16:20,856 - IngestAgent - DEBUG - Final metadata: {
  "source_file": "long_ad_campaign_x.mp4",
  "ingest_timestamp": "2025-07-16T11:16:15.066748",
  "checksum_sha256": "3c195a0507198c7574551ae014247153b20bac784cf0a5c3b1fa5038c2900093",
  "file_size_bytes": 105906176,
  "duration": 60.6,
  "title": "Long Ad Campaign X",
  "genre": "Commercial",
  "language": "English",
  "asset_type": "ad",
  "ai_summary": "\"Long Ad Campaign X\" is a commercial. It presents a series of connected advertisements, presumably for a single product or brand.\n",
  "ai_keywords": [
    "Long Ad Campaign X",
    "commercial",
    "advertisements",
    "product",
    "brand"
  ],
  "mood": "promotional"
}
2025-07-16 11:16:20,857 - IngestAgent - DEBUG - Thought Chain: Executing Content Normalization step.
2025-07-16 11:16:20,858 - IngestAgent - INFO - Starting content normalization for: long_ad_campaign_x.mp4
2025-07-16 11:16:20,858 - IngestAgent - DEBUG - Thought Chain: Initiating content normalization for long_ad_campaign_x.mp4
2025-07-16 11:16:20,858 - IngestAgent - DEBUG - Thought Chain: Determined normalized name: asset_b1e2f6ec_long_ad_campaign_x.mp4. Justification: Standard naming convention applied.
2025-07-16 11:16:20,859 - IngestAgent - INFO - Normalized and moved long_ad_campaign_x.mp4 to ./ingest_processed/asset_b1e2f6ec_long_ad_campaign_x.mp4
2025-07-16 11:16:20,859 - IngestAgent - DEBUG - Thought Chain: File successfully moved to normalized path. Justification: Unique content, moved to standard location. Adding checksum to processed set.
2025-07-16 11:16:20,859 - IngestAgent - INFO - Content normalization complete for ./ingest_source/long_ad_campaign_x.mp4.
2025-07-16 11:16:20,860 - IngestAgent - DEBUG - Thought Chain: Content normalization process concluded.
2025-07-16 11:16:20,860 - IngestAgent - DEBUG - Thought Chain: Executing Policy Compliance Check step.
2025-07-16 11:16:20,861 - IngestAgent - INFO - Starting policy compliance check for asset: Long Ad Campaign X
2025-07-16 11:16:20,861 - IngestAgent - DEBUG - Thought Chain: Initiating policy compliance check.
2025-07-16 11:16:20,861 - IngestAgent - DEBUG - Thought Chain: Required field 'title' is present. Justification: Metadata completeness criteria met for this field.
2025-07-16 11:16:20,861 - IngestAgent - DEBUG - Thought Chain: Required field 'genre' is present. Justification: Metadata completeness criteria met for this field.
2025-07-16 11:16:20,862 - IngestAgent - DEBUG - Thought Chain: Required field 'language' is present. Justification: Metadata completeness criteria met for this field.
2025-07-16 11:16:20,862 - IngestAgent - DEBUG - Thought Chain: Checking duration policy. Duration: 60.60s, Asset Type: ad
2025-07-16 11:16:20,862 - IngestAgent - DEBUG - Thought Chain: Ad duration policy violated. Justification: Duration exceeds ad-specific limit. Escalation triggered.
2025-07-16 11:16:20,862 - IngestAgent - DEBUG - Thought Chain: Checking file size policy. Size: 101.00 MB, Max: 40960 MB.
2025-07-16 11:16:20,862 - IngestAgent - DEBUG - Thought Chain: File size is within allowed limits. Justification: Complies with file size policy.
2025-07-16 11:16:20,862 - IngestAgent - DEBUG - Thought Chain: Checking E/I rating for kids content.
2025-07-16 11:16:20,863 - IngestAgent - WARNING - Policy compliance issues for Long Ad Campaign X. Flags: ['Ad duration (60.60s) exceeds limit (60s).']
2025-07-16 11:16:20,863 - IngestAgent - DEBUG - Thought Chain: Decision - Policy compliance failed. Status: FAIL. Justification: One or more policy flags were set.
2025-07-16 11:16:20,863 - IngestAgent - ERROR - Escalating asset Long Ad Campaign X to human for review.
2025-07-16 11:16:20,863 - IngestAgent - DEBUG - Thought Chain: Decision - Escalating to human due to critical policy breach. Justification: Escalation flag set by policy check.
2025-07-16 11:16:20,863 - IngestAgent - DEBUG - Thought Chain: Policy compliance check concluded.
2025-07-16 11:16:20,864 - IngestAgent - DEBUG - Thought Chain: Executing Event-Driven Hand-off step.
2025-07-16 11:16:20,865 - IngestAgent - INFO - Handing off asset to downstream agents: N/A
2025-07-16 11:16:20,865 - IngestAgent - DEBUG - Thought Chain: Initiating hand-off process.
2025-07-16 11:16:20,865 - IngestAgent - INFO - Context Shared (simulated hand-off):
{
  "original_path": "./ingest_source/long_ad_campaign_x.mp4",
  "ingest_start_time": "2025-07-16T11:16:15.058160",
  "status": "FAILED_COMPLIANCE",
  "format_valid": true,
  "format_issues": [],
  "transcode_needed": false,
  "initial_transcode_required": false,
  "ffprobe_data": {
    "format": {
      "filename": "long_ad_campaign_x.mp4",
      "nb_streams": 2,
      "format_name": "mp4",
      "duration": 60.6,
      "size": 105906176
    },
    "streams": [
      {
        "codec_type": "video",
        "codec_name": "h264",
        "width": 1920,
        "height": 1080,
        "avg_frame_rate": "25/1",
        "display_aspect_ratio": "16:9"
      },
      {
        "codec_type": "audio",
        "codec_name": "aac",
        "channels": 2
      }
    ]
  },
  "metadata": {
    "source_file": "long_ad_campaign_x.mp4",
    "ingest_timestamp": "2025-07-16T11:16:15.066748",
    "checksum_sha256": "3c195a0507198c7574551ae014247153b20bac784cf0a5c3b1fa5038c2900093",
    "file_size_bytes": 105906176,
    "duration": 60.6,
    "title": "Long Ad Campaign X",
    "genre": "Commercial",
    "language": "English",
    "asset_type": "ad",
    "ai_summary": "\"Long Ad Campaign X\" is a commercial. It presents a series of connected advertisements, presumably for a single product or brand.\n",
    "ai_keywords": [
      "Long Ad Campaign X",
      "commercial",
      "advertisements",
      "product",
      "brand"
    ],
    "mood": "promotional",
    "normalized_file_path": "./ingest_processed/asset_b1e2f6ec_long_ad_campaign_x.mp4",
    "normalized_file_name": "asset_b1e2f6ec_long_ad_campaign_x.mp4",
    "compliance_status": "FAIL",
    "compliance_flags": [
      "Ad duration (60.60s) exceeds limit (60s)."
    ],
    "escalate_to_human": true
  },
  "normalized_file_path": "./ingest_processed/asset_b1e2f6ec_long_ad_campaign_x.mp4",
  "escalate_to_human": true,
  "ingest_end_time": "2025-07-16T11:16:20.864833"
}
2025-07-16 11:16:20,868 - IngestAgent - DEBUG - Thought Chain: Hand-off completed successfully. Justification: Asset is compliant or issues were handled internally.
2025-07-16 11:16:20,868 - IngestAgent - INFO - Hand-off complete.
2025-07-16 11:16:20,869 - IngestAgent - INFO - --- Ingestion pipeline completed for: ./ingest_source/long_ad_campaign_x.mp4 ---
2025-07-16 11:16:20,869 - IngestAgent - DEBUG - Thought Chain: Pipeline completed successfully for ./ingest_source/long_ad_campaign_x.mp4.
2025-07-16 11:16:21,582 - IngestAgent - INFO - --- Starting ingestion pipeline for: ./ingest_source/ad_missing_meta.mp4 ---
2025-07-16 11:16:21,583 - IngestAgent - DEBUG - Thought Chain: Pipeline started for ./ingest_source/ad_missing_meta.mp4.
2025-07-16 11:16:21,583 - IngestAgent - INFO - No initial sidecar JSON found for ./ingest_source/ad_missing_meta.mp4.
2025-07-16 11:16:21,583 - IngestAgent - DEBUG - Thought Chain: Executing Format Detection & Validation step.
2025-07-16 11:16:21,583 - IngestAgent - INFO - Starting format detection for: ./ingest_source/ad_missing_meta.mp4
2025-07-16 11:16:21,583 - IngestAgent - DEBUG - Thought Chain: Initiating FFprobe simulation for ./ingest_source/ad_missing_meta.mp4
2025-07-16 11:16:21,584 - IngestAgent - DEBUG - Simulated FFprobe for ./ingest_source/ad_missing_meta.mp4: {'format': {'filename': 'ad_missing_meta.mp4', 'nb_streams': 2, 'format_name': 'mp4', 'duration': 3.0, 'size': 5242880}, 'streams': [{'codec_type': 'video', 'codec_name': 'h264', 'width': 1920, 'height': 1080, 'avg_frame_rate': '25/1', 'display_aspect_ratio': '16:9'}, {'codec_type': 'audio', 'codec_name': 'aac', 'channels': 2}]}
2025-07-16 11:16:21,584 - IngestAgent - DEBUG - Thought Chain: File extension 'mp4' is allowed. Justification: Complies with 'allowed_formats' policy.
2025-07-16 11:16:21,585 - IngestAgent - DEBUG - Thought Chain: No operator override for transcode detected. Justification: Proceeding with standard transcode decision.
2025-07-16 11:16:21,585 - IngestAgent - INFO - Format validation successful for ./ingest_source/ad_missing_meta.mp4.
2025-07-16 11:16:21,585 - IngestAgent - DEBUG - Thought Chain: Decision - Format is compliant. No transcode needed. Justification: All format policies passed.
2025-07-16 11:16:21,586 - IngestAgent - INFO - Format validation successful for ./ingest_source/ad_missing_meta.mp4.
2025-07-16 11:16:21,586 - IngestAgent - DEBUG - Thought Chain: Executing Metadata Extraction & Enrichment step.
2025-07-16 11:16:21,586 - IngestAgent - INFO - Starting metadata extraction for: ./ingest_source/ad_missing_meta.mp4
2025-07-16 11:16:21,586 - IngestAgent - DEBUG - Thought Chain: Initiating metadata extraction and enrichment for ./ingest_source/ad_missing_meta.mp4
2025-07-16 11:16:21,652 - IngestAgent - DEBUG - Calculated sha256 checksum for ./ingest_source/ad_missing_meta.mp4
2025-07-16 11:16:21,653 - IngestAgent - DEBUG - Thought Chain: Basic metadata extracted from file system and FFprobe data.
2025-07-16 11:16:21,653 - IngestAgent - INFO - No sidecar JSON found for ./ingest_source/ad_missing_meta.mp4.
2025-07-16 11:16:21,653 - IngestAgent - DEBUG - Thought Chain: No sidecar JSON found. Justification: No external metadata provided. Proceeding without it.
2025-07-16 11:16:21,653 - IngestAgent - DEBUG - Thought Chain: Title not found. Justification: Inferred from filename as per policy.
2025-07-16 11:16:21,654 - IngestAgent - DEBUG - Thought Chain: Determining asset type for ad_missing_meta.mp4
2025-07-16 11:16:21,654 - IngestAgent - DEBUG - Thought Chain: Identified as 'ad' based on filename heuristic.
2025-07-16 11:16:21,654 - IngestAgent - DEBUG - Thought Chain: Determined asset type: ad.
2025-07-16 11:16:21,654 - IngestAgent - INFO - Determined asset type: ad
2025-07-16 11:16:21,654 - IngestAgent - INFO - Performing real AI enrichment for asset type: ad
2025-07-16 11:16:21,655 - IngestAgent - DEBUG - Thought Chain: Starting AI enrichment. Initial metadata: Ad Missing Meta, type: ad
2025-07-16 11:16:21,655 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI summary based on prompt: 'Generate a very short, concise summary (max 2 sentences) for a media a...'
2025-07-16 11:16:21,655 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:22,675 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:22,676 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI summary. Justification: LLM provided concise overview based on title/genre.
2025-07-16 11:16:22,677 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI keywords based on prompt: 'Extract up to 5 keywords from the following media asset description: '...'
2025-07-16 11:16:22,678 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:23,718 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:23,720 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI keywords. Justification: LLM provided relevant keywords in expected format.
2025-07-16 11:16:23,722 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI mood based on prompt: 'Based on the genre 'N/A' and summary 'The media asset "Ad Missing Meta...'
2025-07-16 11:16:23,722 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:24,536 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:24,537 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI mood. Justification: LLM provided a single-word mood based on context.
2025-07-16 11:16:24,538 - IngestAgent - DEBUG - Real AI enrichment complete. New metadata: {'source_file': 'ad_missing_meta.mp4', 'ingest_timestamp': '2025-07-16T11:16:21.587356', 'checksum_sha256': 'dbbe5517996826bd5861ac22b745d21d11219055d89243ca1aea0ad31f552b12', 'file_size_bytes': 5242880, 'duration': 3.0, 'title': 'Ad Missing Meta', 'asset_type': 'ad', 'ai_summary': 'The media asset "Ad Missing Meta" contains unspecified content of an unknown genre. No further information is discernable from the title and genre.\n', 'ai_keywords': ['Ad Missing Meta', 'unspecified content', 'unknown genre'], 'mood': 'unknown'}
2025-07-16 11:16:24,538 - IngestAgent - DEBUG - Thought Chain: AI enrichment process concluded.
2025-07-16 11:16:24,539 - IngestAgent - INFO - Metadata extraction and enrichment complete for ./ingest_source/ad_missing_meta.mp4.
2025-07-16 11:16:24,539 - IngestAgent - DEBUG - Thought Chain: Metadata extraction and enrichment process concluded.
2025-07-16 11:16:24,539 - IngestAgent - DEBUG - Final metadata: {
  "source_file": "ad_missing_meta.mp4",
  "ingest_timestamp": "2025-07-16T11:16:21.587356",
  "checksum_sha256": "dbbe5517996826bd5861ac22b745d21d11219055d89243ca1aea0ad31f552b12",
  "file_size_bytes": 5242880,
  "duration": 3.0,
  "title": "Ad Missing Meta",
  "asset_type": "ad",
  "ai_summary": "The media asset \"Ad Missing Meta\" contains unspecified content of an unknown genre. No further information is discernable from the title and genre.\n",
  "ai_keywords": [
    "Ad Missing Meta",
    "unspecified content",
    "unknown genre"
  ],
  "mood": "unknown"
}
2025-07-16 11:16:24,541 - IngestAgent - DEBUG - Thought Chain: Executing Content Normalization step.
2025-07-16 11:16:24,541 - IngestAgent - INFO - Starting content normalization for: ad_missing_meta.mp4
2025-07-16 11:16:24,542 - IngestAgent - DEBUG - Thought Chain: Initiating content normalization for ad_missing_meta.mp4
2025-07-16 11:16:24,542 - IngestAgent - DEBUG - Thought Chain: Determined normalized name: asset_528237c3_ad_missing_meta.mp4. Justification: Standard naming convention applied.
2025-07-16 11:16:24,543 - IngestAgent - INFO - Normalized and moved ad_missing_meta.mp4 to ./ingest_processed/asset_528237c3_ad_missing_meta.mp4
2025-07-16 11:16:24,543 - IngestAgent - DEBUG - Thought Chain: File successfully moved to normalized path. Justification: Unique content, moved to standard location. Adding checksum to processed set.
2025-07-16 11:16:24,543 - IngestAgent - INFO - Content normalization complete for ./ingest_source/ad_missing_meta.mp4.
2025-07-16 11:16:24,543 - IngestAgent - DEBUG - Thought Chain: Content normalization process concluded.
2025-07-16 11:16:24,544 - IngestAgent - DEBUG - Thought Chain: Executing Policy Compliance Check step.
2025-07-16 11:16:24,544 - IngestAgent - INFO - Starting policy compliance check for asset: Ad Missing Meta
2025-07-16 11:16:24,545 - IngestAgent - DEBUG - Thought Chain: Initiating policy compliance check.
2025-07-16 11:16:24,545 - IngestAgent - DEBUG - Thought Chain: Required field 'title' is present. Justification: Metadata completeness criteria met for this field.
2025-07-16 11:16:24,545 - IngestAgent - DEBUG - Thought Chain: Missing required field 'genre'. Justification: Policy 'required_metadata_fields' violated. Escalation triggered.
2025-07-16 11:16:24,545 - IngestAgent - DEBUG - Thought Chain: Missing required field 'language'. Justification: Policy 'required_metadata_fields' violated. Escalation triggered.
2025-07-16 11:16:24,545 - IngestAgent - DEBUG - Thought Chain: Checking duration policy. Duration: 3.00s, Asset Type: ad
2025-07-16 11:16:24,545 - IngestAgent - DEBUG - Thought Chain: Checking file size policy. Size: 5.00 MB, Max: 40960 MB.
2025-07-16 11:16:24,545 - IngestAgent - DEBUG - Thought Chain: File size is within allowed limits. Justification: Complies with file size policy.
2025-07-16 11:16:24,546 - IngestAgent - DEBUG - Thought Chain: Checking E/I rating for kids content.
2025-07-16 11:16:24,546 - IngestAgent - WARNING - Policy compliance issues for Ad Missing Meta. Flags: ['Missing required metadata field: genre.', 'Missing required metadata field: language.']
2025-07-16 11:16:24,546 - IngestAgent - DEBUG - Thought Chain: Decision - Policy compliance failed. Status: FAIL. Justification: One or more policy flags were set.
2025-07-16 11:16:24,546 - IngestAgent - ERROR - Escalating asset Ad Missing Meta to human for review.
2025-07-16 11:16:24,546 - IngestAgent - DEBUG - Thought Chain: Decision - Escalating to human due to critical policy breach. Justification: Escalation flag set by policy check.
2025-07-16 11:16:24,546 - IngestAgent - DEBUG - Thought Chain: Policy compliance check concluded.
2025-07-16 11:16:24,547 - IngestAgent - DEBUG - Thought Chain: Executing Event-Driven Hand-off step.
2025-07-16 11:16:24,547 - IngestAgent - INFO - Handing off asset to downstream agents: N/A
2025-07-16 11:16:24,547 - IngestAgent - DEBUG - Thought Chain: Initiating hand-off process.
2025-07-16 11:16:24,548 - IngestAgent - INFO - Context Shared (simulated hand-off):
{
  "original_path": "./ingest_source/ad_missing_meta.mp4",
  "ingest_start_time": "2025-07-16T11:16:21.582778",
  "status": "FAILED_COMPLIANCE",
  "format_valid": true,
  "format_issues": [],
  "transcode_needed": false,
  "initial_transcode_required": false,
  "ffprobe_data": {
    "format": {
      "filename": "ad_missing_meta.mp4",
      "nb_streams": 2,
      "format_name": "mp4",
      "duration": 3.0,
      "size": 5242880
    },
    "streams": [
      {
        "codec_type": "video",
        "codec_name": "h264",
        "width": 1920,
        "height": 1080,
        "avg_frame_rate": "25/1",
        "display_aspect_ratio": "16:9"
      },
      {
        "codec_type": "audio",
        "codec_name": "aac",
        "channels": 2
      }
    ]
  },
  "metadata": {
    "source_file": "ad_missing_meta.mp4",
    "ingest_timestamp": "2025-07-16T11:16:21.587356",
    "checksum_sha256": "dbbe5517996826bd5861ac22b745d21d11219055d89243ca1aea0ad31f552b12",
    "file_size_bytes": 5242880,
    "duration": 3.0,
    "title": "Ad Missing Meta",
    "asset_type": "ad",
    "ai_summary": "The media asset \"Ad Missing Meta\" contains unspecified content of an unknown genre. No further information is discernable from the title and genre.\n",
    "ai_keywords": [
      "Ad Missing Meta",
      "unspecified content",
      "unknown genre"
    ],
    "mood": "unknown",
    "normalized_file_path": "./ingest_processed/asset_528237c3_ad_missing_meta.mp4",
    "normalized_file_name": "asset_528237c3_ad_missing_meta.mp4",
    "compliance_status": "FAIL",
    "compliance_flags": [
      "Missing required metadata field: genre.",
      "Missing required metadata field: language."
    ],
    "escalate_to_human": true
  },
  "normalized_file_path": "./ingest_processed/asset_528237c3_ad_missing_meta.mp4",
  "escalate_to_human": true,
  "ingest_end_time": "2025-07-16T11:16:24.547310"
}
2025-07-16 11:16:24,548 - IngestAgent - DEBUG - Thought Chain: Hand-off completed successfully. Justification: Asset is compliant or issues were handled internally.
2025-07-16 11:16:24,549 - IngestAgent - INFO - Hand-off complete.
2025-07-16 11:16:24,549 - IngestAgent - INFO - --- Ingestion pipeline completed for: ./ingest_source/ad_missing_meta.mp4 ---
2025-07-16 11:16:24,549 - IngestAgent - DEBUG - Thought Chain: Pipeline completed successfully for ./ingest_source/ad_missing_meta.mp4.
2025-07-16 11:16:25,256 - IngestAgent - INFO - --- Starting ingestion pipeline for: ./ingest_source/corrupted_header.mp4 ---
2025-07-16 11:16:25,256 - IngestAgent - DEBUG - Thought Chain: Pipeline started for ./ingest_source/corrupted_header.mp4.
2025-07-16 11:16:25,256 - IngestAgent - INFO - No initial sidecar JSON found for ./ingest_source/corrupted_header.mp4.
2025-07-16 11:16:25,257 - IngestAgent - DEBUG - Thought Chain: Executing Format Detection & Validation step.
2025-07-16 11:16:25,258 - IngestAgent - INFO - Starting format detection for: ./ingest_source/corrupted_header.mp4
2025-07-16 11:16:25,258 - IngestAgent - DEBUG - Thought Chain: Initiating FFprobe simulation for ./ingest_source/corrupted_header.mp4
2025-07-16 11:16:25,259 - IngestAgent - WARNING - Simulating FFprobe failure for ./ingest_source/corrupted_header.mp4 due to suspected corruption by name.
2025-07-16 11:16:25,259 - IngestAgent - DEBUG - Thought Chain: FFprobe simulation failed. Justification: Simulated corrupted header or unreadable file. Format invalid.
2025-07-16 11:16:25,260 - IngestAgent - ERROR - Ingestion failed for ./ingest_source/corrupted_header.mp4: Format invalid and transcode not applicable/possible.
2025-07-16 11:16:25,260 - IngestAgent - INFO - Handing off asset to downstream agents: N/A
2025-07-16 11:16:25,260 - IngestAgent - DEBUG - Thought Chain: Initiating hand-off process.
2025-07-16 11:16:25,261 - IngestAgent - INFO - Context Shared (simulated hand-off):
{
  "original_path": "./ingest_source/corrupted_header.mp4",
  "ingest_start_time": "2025-07-16T11:16:25.255948",
  "status": "FAILED_FORMAT_VALIDATION",
  "format_valid": false,
  "format_issues": [
    "Could not get format information (FFprobe simulation failed)."
  ],
  "transcode_needed": false,
  "initial_transcode_required": false,
  "ffprobe_data": {}
}
2025-07-16 11:16:25,261 - IngestAgent - DEBUG - Thought Chain: Hand-off completed successfully. Justification: Asset is compliant or issues were handled internally.
2025-07-16 11:16:25,261 - IngestAgent - INFO - Hand-off complete.
2025-07-16 11:16:25,777 - IngestAgent - INFO - --- Starting ingestion pipeline for: ./ingest_source/oversized_file_test.mp4 ---
2025-07-16 11:16:25,777 - IngestAgent - DEBUG - Thought Chain: Pipeline started for ./ingest_source/oversized_file_test.mp4.
2025-07-16 11:16:25,777 - IngestAgent - INFO - No initial sidecar JSON found for ./ingest_source/oversized_file_test.mp4.
2025-07-16 11:16:25,778 - IngestAgent - DEBUG - Thought Chain: Executing Format Detection & Validation step.
2025-07-16 11:16:25,795 - IngestAgent - INFO - Starting format detection for: ./ingest_source/oversized_file_test.mp4
2025-07-16 11:16:25,796 - IngestAgent - DEBUG - Thought Chain: Initiating FFprobe simulation for ./ingest_source/oversized_file_test.mp4
2025-07-16 11:16:25,796 - IngestAgent - WARNING - Simulating FFprobe reporting 50GB size for oversized file: ./ingest_source/oversized_file_test.mp4
2025-07-16 11:16:25,796 - IngestAgent - DEBUG - Simulated FFprobe for ./ingest_source/oversized_file_test.mp4: {'format': {'filename': 'oversized_file_test.mp4', 'nb_streams': 2, 'format_name': 'mp4', 'duration': 30720.0, 'size': 53687091200}, 'streams': [{'codec_type': 'video', 'codec_name': 'h264', 'width': 1920, 'height': 1080, 'avg_frame_rate': '25/1', 'display_aspect_ratio': '16:9'}, {'codec_type': 'audio', 'codec_name': 'aac', 'channels': 2}]}
2025-07-16 11:16:25,798 - IngestAgent - DEBUG - Thought Chain: File extension 'mp4' is allowed. Justification: Complies with 'allowed_formats' policy.
2025-07-16 11:16:25,798 - IngestAgent - DEBUG - Thought Chain: No operator override for transcode detected. Justification: Proceeding with standard transcode decision.
2025-07-16 11:16:25,798 - IngestAgent - INFO - Format validation successful for ./ingest_source/oversized_file_test.mp4.
2025-07-16 11:16:25,798 - IngestAgent - DEBUG - Thought Chain: Decision - Format is compliant. No transcode needed. Justification: All format policies passed.
2025-07-16 11:16:25,800 - IngestAgent - INFO - Format validation successful for ./ingest_source/oversized_file_test.mp4.
2025-07-16 11:16:25,800 - IngestAgent - DEBUG - Thought Chain: Executing Metadata Extraction & Enrichment step.
2025-07-16 11:16:25,800 - IngestAgent - INFO - Starting metadata extraction for: ./ingest_source/oversized_file_test.mp4
2025-07-16 11:16:25,800 - IngestAgent - DEBUG - Thought Chain: Initiating metadata extraction and enrichment for ./ingest_source/oversized_file_test.mp4
2025-07-16 11:16:25,911 - IngestAgent - DEBUG - Calculated sha256 checksum for ./ingest_source/oversized_file_test.mp4
2025-07-16 11:16:25,913 - IngestAgent - DEBUG - Thought Chain: Basic metadata extracted from file system and FFprobe data.
2025-07-16 11:16:25,914 - IngestAgent - INFO - No sidecar JSON found for ./ingest_source/oversized_file_test.mp4.
2025-07-16 11:16:25,914 - IngestAgent - DEBUG - Thought Chain: No sidecar JSON found. Justification: No external metadata provided. Proceeding without it.
2025-07-16 11:16:25,914 - IngestAgent - DEBUG - Thought Chain: Title not found. Justification: Inferred from filename as per policy.
2025-07-16 11:16:25,914 - IngestAgent - DEBUG - Thought Chain: Determining asset type for oversized_file_test.mp4
2025-07-16 11:16:25,914 - IngestAgent - DEBUG - Thought Chain: Determined asset type: episode.
2025-07-16 11:16:25,915 - IngestAgent - INFO - Determined asset type: episode
2025-07-16 11:16:25,916 - IngestAgent - INFO - Performing real AI enrichment for asset type: episode
2025-07-16 11:16:25,916 - IngestAgent - DEBUG - Thought Chain: Starting AI enrichment. Initial metadata: Oversized File Test, type: episode
2025-07-16 11:16:25,916 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI summary based on prompt: 'Generate a very short, concise summary (max 2 sentences) for a media a...'
2025-07-16 11:16:25,916 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:26,993 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:26,994 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI summary. Justification: LLM provided concise overview based on title/genre.
2025-07-16 11:16:26,995 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI keywords based on prompt: 'Extract up to 5 keywords from the following media asset description: '...'
2025-07-16 11:16:26,996 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:28,020 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:28,022 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI keywords. Justification: LLM provided relevant keywords in expected format.
2025-07-16 11:16:28,023 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI mood based on prompt: 'Based on the genre 'N/A' and summary 'This media asset, "Oversized Fil...'
2025-07-16 11:16:28,023 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:29,959 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:29,961 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI mood. Justification: LLM provided a single-word mood based on context.
2025-07-16 11:16:29,961 - IngestAgent - DEBUG - Real AI enrichment complete. New metadata: {'source_file': 'oversized_file_test.mp4', 'ingest_timestamp': '2025-07-16T11:16:25.801081', 'checksum_sha256': '4e29ad18ab9f42d7c233500771a39d7c852b200baf328fd00fbbe3fecea1eb56', 'file_size_bytes': 53687091200, 'duration': 30720.0, 'title': 'Oversized File Test', 'asset_type': 'episode', 'ai_summary': 'This media asset, "Oversized File Test," appears to be a data file with unknown content. The genre is listed as "N/A."\n', 'ai_keywords': ['Oversized File Test', 'data file', 'unknown content', 'N/A'], 'mood': 'neutral'}
2025-07-16 11:16:29,962 - IngestAgent - DEBUG - Thought Chain: AI enrichment process concluded.
2025-07-16 11:16:29,962 - IngestAgent - INFO - Metadata extraction and enrichment complete for ./ingest_source/oversized_file_test.mp4.
2025-07-16 11:16:29,962 - IngestAgent - DEBUG - Thought Chain: Metadata extraction and enrichment process concluded.
2025-07-16 11:16:29,963 - IngestAgent - DEBUG - Final metadata: {
  "source_file": "oversized_file_test.mp4",
  "ingest_timestamp": "2025-07-16T11:16:25.801081",
  "checksum_sha256": "4e29ad18ab9f42d7c233500771a39d7c852b200baf328fd00fbbe3fecea1eb56",
  "file_size_bytes": 53687091200,
  "duration": 30720.0,
  "title": "Oversized File Test",
  "asset_type": "episode",
  "ai_summary": "This media asset, \"Oversized File Test,\" appears to be a data file with unknown content. The genre is listed as \"N/A.\"\n",
  "ai_keywords": [
    "Oversized File Test",
    "data file",
    "unknown content",
    "N/A"
  ],
  "mood": "neutral"
}
2025-07-16 11:16:29,964 - IngestAgent - DEBUG - Thought Chain: Executing Content Normalization step.
2025-07-16 11:16:29,964 - IngestAgent - INFO - Starting content normalization for: oversized_file_test.mp4
2025-07-16 11:16:29,964 - IngestAgent - DEBUG - Thought Chain: Initiating content normalization for oversized_file_test.mp4
2025-07-16 11:16:29,964 - IngestAgent - DEBUG - Thought Chain: Determined normalized name: asset_50c7b401_oversized_file_test.mp4. Justification: Standard naming convention applied.
2025-07-16 11:16:29,964 - IngestAgent - INFO - Skipping move for duplicate file oversized_file_test.mp4. Already processed content.
2025-07-16 11:16:29,964 - IngestAgent - DEBUG - Thought Chain: Not moving duplicate file. Justification: Content hash matches existing processed asset. Content already exists in normalized form.
2025-07-16 11:16:29,965 - IngestAgent - INFO - Content normalization complete for ./ingest_source/oversized_file_test.mp4.
2025-07-16 11:16:29,965 - IngestAgent - DEBUG - Thought Chain: Content normalization process concluded.
2025-07-16 11:16:29,966 - IngestAgent - INFO - Ingestion pipeline skipped for ./ingest_source/oversized_file_test.mp4: Duplicate content detected.
2025-07-16 11:16:29,966 - IngestAgent - DEBUG - Thought Chain: Decision - Pipeline terminated due to duplicate content. Justification: Asset content already exists in the system.
2025-07-16 11:16:29,966 - IngestAgent - INFO - Handing off asset to downstream agents: N/A
2025-07-16 11:16:29,966 - IngestAgent - DEBUG - Thought Chain: Initiating hand-off process.
2025-07-16 11:16:29,966 - IngestAgent - INFO - Context Shared (simulated hand-off):
{
  "original_path": "./ingest_source/oversized_file_test.mp4",
  "ingest_start_time": "2025-07-16T11:16:25.777384",
  "status": "DUPLICATE_SKIPPED",
  "format_valid": true,
  "format_issues": [],
  "transcode_needed": false,
  "initial_transcode_required": false,
  "ffprobe_data": {
    "format": {
      "filename": "oversized_file_test.mp4",
      "nb_streams": 2,
      "format_name": "mp4",
      "duration": 30720.0,
      "size": 53687091200
    },
    "streams": [
      {
        "codec_type": "video",
        "codec_name": "h264",
        "width": 1920,
        "height": 1080,
        "avg_frame_rate": "25/1",
        "display_aspect_ratio": "16:9"
      },
      {
        "codec_type": "audio",
        "codec_name": "aac",
        "channels": 2
      }
    ]
  },
  "metadata": {
    "source_file": "oversized_file_test.mp4",
    "ingest_timestamp": "2025-07-16T11:16:25.801081",
    "checksum_sha256": "4e29ad18ab9f42d7c233500771a39d7c852b200baf328fd00fbbe3fecea1eb56",
    "file_size_bytes": 53687091200,
    "duration": 30720.0,
    "title": "Oversized File Test",
    "asset_type": "episode",
    "ai_summary": "This media asset, \"Oversized File Test,\" appears to be a data file with unknown content. The genre is listed as \"N/A.\"\n",
    "ai_keywords": [
      "Oversized File Test",
      "data file",
      "unknown content",
      "N/A"
    ],
    "mood": "neutral",
    "normalized_file_path": "DUPLICATE_SKIPPED_MOVE",
    "normalized_file_name": "DUPLICATE_SKIPPED_MOVE"
  }
}
2025-07-16 11:16:29,968 - IngestAgent - DEBUG - Thought Chain: Hand-off completed successfully. Justification: Asset is compliant or issues were handled internally.
2025-07-16 11:16:29,969 - IngestAgent - INFO - Hand-off complete.
2025-07-16 11:16:30,474 - IngestAgent - INFO - --- Starting ingestion pipeline for: ./ingest_source/duplicate_content_video.mp4 ---
2025-07-16 11:16:30,475 - IngestAgent - DEBUG - Thought Chain: Pipeline started for ./ingest_source/duplicate_content_video.mp4.
2025-07-16 11:16:30,475 - IngestAgent - DEBUG - Thought Chain: Loaded initial metadata from sidecar for override checks.
2025-07-16 11:16:30,476 - IngestAgent - DEBUG - Thought Chain: Executing Format Detection & Validation step.
2025-07-16 11:16:30,476 - IngestAgent - INFO - Starting format detection for: ./ingest_source/duplicate_content_video.mp4
2025-07-16 11:16:30,476 - IngestAgent - DEBUG - Thought Chain: Initiating FFprobe simulation for ./ingest_source/duplicate_content_video.mp4
2025-07-16 11:16:30,477 - IngestAgent - DEBUG - Simulated FFprobe for ./ingest_source/duplicate_content_video.mp4: {'format': {'filename': 'duplicate_content_video.mp4', 'nb_streams': 2, 'format_name': 'mp4', 'duration': 6.0, 'size': 10485760}, 'streams': [{'codec_type': 'video', 'codec_name': 'h264', 'width': 1920, 'height': 1080, 'avg_frame_rate': '25/1', 'display_aspect_ratio': '16:9'}, {'codec_type': 'audio', 'codec_name': 'aac', 'channels': 2}]}
2025-07-16 11:16:30,478 - IngestAgent - DEBUG - Thought Chain: File extension 'mp4' is allowed. Justification: Complies with 'allowed_formats' policy.
2025-07-16 11:16:30,478 - IngestAgent - DEBUG - Thought Chain: No operator override for transcode detected. Justification: Proceeding with standard transcode decision.
2025-07-16 11:16:30,478 - IngestAgent - INFO - Format validation successful for ./ingest_source/duplicate_content_video.mp4.
2025-07-16 11:16:30,478 - IngestAgent - DEBUG - Thought Chain: Decision - Format is compliant. No transcode needed. Justification: All format policies passed.
2025-07-16 11:16:30,479 - IngestAgent - INFO - Format validation successful for ./ingest_source/duplicate_content_video.mp4.
2025-07-16 11:16:30,479 - IngestAgent - DEBUG - Thought Chain: Executing Metadata Extraction & Enrichment step.
2025-07-16 11:16:30,479 - IngestAgent - INFO - Starting metadata extraction for: ./ingest_source/duplicate_content_video.mp4
2025-07-16 11:16:30,479 - IngestAgent - DEBUG - Thought Chain: Initiating metadata extraction and enrichment for ./ingest_source/duplicate_content_video.mp4
2025-07-16 11:16:31,150 - IngestAgent - DEBUG - Calculated sha256 checksum for ./ingest_source/duplicate_content_video.mp4
2025-07-16 11:16:31,151 - IngestAgent - DEBUG - Thought Chain: Basic metadata extracted from file system and FFprobe data.
2025-07-16 11:16:31,152 - IngestAgent - INFO - Extracted metadata from sidecar: ./ingest_source/duplicate_content_video.json
2025-07-16 11:16:31,153 - IngestAgent - DEBUG - Thought Chain: Sidecar JSON found and merged. Justification: External metadata source provided.
2025-07-16 11:16:31,156 - IngestAgent - DEBUG - Thought Chain: Title already present in metadata. Justification: Existing metadata takes precedence.
2025-07-16 11:16:31,156 - IngestAgent - DEBUG - Thought Chain: Determining asset type for duplicate_content_video.mp4
2025-07-16 11:16:31,156 - IngestAgent - DEBUG - Thought Chain: Determined asset type: episode.
2025-07-16 11:16:31,157 - IngestAgent - INFO - Determined asset type: episode
2025-07-16 11:16:31,158 - IngestAgent - INFO - Performing real AI enrichment for asset type: episode
2025-07-16 11:16:31,158 - IngestAgent - DEBUG - Thought Chain: Starting AI enrichment. Initial metadata: Duplicate Content, type: episode
2025-07-16 11:16:31,159 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI summary based on prompt: 'Generate a very short, concise summary (max 2 sentences) for a media a...'
2025-07-16 11:16:31,159 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:32,295 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:32,296 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI summary. Justification: LLM provided concise overview based on title/genre.
2025-07-16 11:16:32,297 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI keywords based on prompt: 'Extract up to 5 keywords from the following media asset description: '...'
2025-07-16 11:16:32,298 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:33,215 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:33,217 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI keywords. Justification: LLM provided relevant keywords in expected format.
2025-07-16 11:16:33,218 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI mood based on prompt: 'Based on the genre 'Test' and summary 'This "Test" asset titled "Dupli...'
2025-07-16 11:16:33,219 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:35,163 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:35,164 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI mood. Justification: LLM provided a single-word mood based on context.
2025-07-16 11:16:35,165 - IngestAgent - DEBUG - Real AI enrichment complete. New metadata: {'source_file': 'duplicate_content_video.mp4', 'ingest_timestamp': '2025-07-16T11:16:30.479952', 'checksum_sha256': 'eb6183addde05c2196ce25e6fa34a4baf20f9bf30d33892f452a9a1e88c9a472', 'file_size_bytes': 10485760, 'duration': 6.0, 'title': 'Duplicate Content', 'genre': 'Test', 'language': 'English', 'asset_type': 'episode', 'ai_summary': 'This "Test" asset titled "Duplicate Content" appears to contain repeated information. The specific content being duplicated is not elaborated upon.\n', 'ai_keywords': ['Duplicate Content', 'Test', 'repeated information'], 'mood': 'neutral'}
2025-07-16 11:16:35,165 - IngestAgent - DEBUG - Thought Chain: AI enrichment process concluded.
2025-07-16 11:16:35,166 - IngestAgent - INFO - Metadata extraction and enrichment complete for ./ingest_source/duplicate_content_video.mp4.
2025-07-16 11:16:35,166 - IngestAgent - DEBUG - Thought Chain: Metadata extraction and enrichment process concluded.
2025-07-16 11:16:35,166 - IngestAgent - DEBUG - Final metadata: {
  "source_file": "duplicate_content_video.mp4",
  "ingest_timestamp": "2025-07-16T11:16:30.479952",
  "checksum_sha256": "eb6183addde05c2196ce25e6fa34a4baf20f9bf30d33892f452a9a1e88c9a472",
  "file_size_bytes": 10485760,
  "duration": 6.0,
  "title": "Duplicate Content",
  "genre": "Test",
  "language": "English",
  "asset_type": "episode",
  "ai_summary": "This \"Test\" asset titled \"Duplicate Content\" appears to contain repeated information. The specific content being duplicated is not elaborated upon.\n",
  "ai_keywords": [
    "Duplicate Content",
    "Test",
    "repeated information"
  ],
  "mood": "neutral"
}
2025-07-16 11:16:35,167 - IngestAgent - DEBUG - Thought Chain: Executing Content Normalization step.
2025-07-16 11:16:35,167 - IngestAgent - INFO - Starting content normalization for: duplicate_content_video.mp4
2025-07-16 11:16:35,168 - IngestAgent - DEBUG - Thought Chain: Initiating content normalization for duplicate_content_video.mp4
2025-07-16 11:16:35,168 - IngestAgent - DEBUG - Thought Chain: Determined normalized name: asset_899e72b2_duplicate_content.mp4. Justification: Standard naming convention applied.
2025-07-16 11:16:35,170 - IngestAgent - INFO - Normalized and moved duplicate_content_video.mp4 to ./ingest_processed/asset_899e72b2_duplicate_content.mp4
2025-07-16 11:16:35,170 - IngestAgent - DEBUG - Thought Chain: File successfully moved to normalized path. Justification: Unique content, moved to standard location. Adding checksum to processed set.
2025-07-16 11:16:35,170 - IngestAgent - INFO - Content normalization complete for ./ingest_source/duplicate_content_video.mp4.
2025-07-16 11:16:35,171 - IngestAgent - DEBUG - Thought Chain: Content normalization process concluded.
2025-07-16 11:16:35,171 - IngestAgent - DEBUG - Thought Chain: Executing Policy Compliance Check step.
2025-07-16 11:16:35,172 - IngestAgent - INFO - Starting policy compliance check for asset: Duplicate Content
2025-07-16 11:16:35,172 - IngestAgent - DEBUG - Thought Chain: Initiating policy compliance check.
2025-07-16 11:16:35,172 - IngestAgent - DEBUG - Thought Chain: Required field 'title' is present. Justification: Metadata completeness criteria met for this field.
2025-07-16 11:16:35,172 - IngestAgent - DEBUG - Thought Chain: Required field 'genre' is present. Justification: Metadata completeness criteria met for this field.
2025-07-16 11:16:35,172 - IngestAgent - DEBUG - Thought Chain: Required field 'language' is present. Justification: Metadata completeness criteria met for this field.
2025-07-16 11:16:35,172 - IngestAgent - DEBUG - Thought Chain: Checking duration policy. Duration: 6.00s, Asset Type: episode
2025-07-16 11:16:35,172 - IngestAgent - DEBUG - Thought Chain: General content duration below minimum. Justification: Duration too short. Escalation triggered.
2025-07-16 11:16:35,174 - IngestAgent - DEBUG - Thought Chain: Checking file size policy. Size: 10.00 MB, Max: 40960 MB.
2025-07-16 11:16:35,178 - IngestAgent - DEBUG - Thought Chain: File size is within allowed limits. Justification: Complies with file size policy.
2025-07-16 11:16:35,178 - IngestAgent - DEBUG - Thought Chain: Checking E/I rating for kids content.
2025-07-16 11:16:35,178 - IngestAgent - WARNING - Policy compliance issues for Duplicate Content. Flags: ['Duration (6.00s) below minimum (10s).']
2025-07-16 11:16:35,178 - IngestAgent - DEBUG - Thought Chain: Decision - Policy compliance failed. Status: FAIL. Justification: One or more policy flags were set.
2025-07-16 11:16:35,178 - IngestAgent - ERROR - Escalating asset Duplicate Content to human for review.
2025-07-16 11:16:35,179 - IngestAgent - DEBUG - Thought Chain: Decision - Escalating to human due to critical policy breach. Justification: Escalation flag set by policy check.
2025-07-16 11:16:35,179 - IngestAgent - DEBUG - Thought Chain: Policy compliance check concluded.
2025-07-16 11:16:35,180 - IngestAgent - DEBUG - Thought Chain: Executing Event-Driven Hand-off step.
2025-07-16 11:16:35,181 - IngestAgent - INFO - Handing off asset to downstream agents: N/A
2025-07-16 11:16:35,181 - IngestAgent - DEBUG - Thought Chain: Initiating hand-off process.
2025-07-16 11:16:35,182 - IngestAgent - INFO - Context Shared (simulated hand-off):
{
  "original_path": "./ingest_source/duplicate_content_video.mp4",
  "ingest_start_time": "2025-07-16T11:16:30.474661",
  "status": "FAILED_COMPLIANCE",
  "format_valid": true,
  "format_issues": [],
  "transcode_needed": false,
  "initial_transcode_required": false,
  "ffprobe_data": {
    "format": {
      "filename": "duplicate_content_video.mp4",
      "nb_streams": 2,
      "format_name": "mp4",
      "duration": 6.0,
      "size": 10485760
    },
    "streams": [
      {
        "codec_type": "video",
        "codec_name": "h264",
        "width": 1920,
        "height": 1080,
        "avg_frame_rate": "25/1",
        "display_aspect_ratio": "16:9"
      },
      {
        "codec_type": "audio",
        "codec_name": "aac",
        "channels": 2
      }
    ]
  },
  "metadata": {
    "source_file": "duplicate_content_video.mp4",
    "ingest_timestamp": "2025-07-16T11:16:30.479952",
    "checksum_sha256": "eb6183addde05c2196ce25e6fa34a4baf20f9bf30d33892f452a9a1e88c9a472",
    "file_size_bytes": 10485760,
    "duration": 6.0,
    "title": "Duplicate Content",
    "genre": "Test",
    "language": "English",
    "asset_type": "episode",
    "ai_summary": "This \"Test\" asset titled \"Duplicate Content\" appears to contain repeated information. The specific content being duplicated is not elaborated upon.\n",
    "ai_keywords": [
      "Duplicate Content",
      "Test",
      "repeated information"
    ],
    "mood": "neutral",
    "normalized_file_path": "./ingest_processed/asset_899e72b2_duplicate_content.mp4",
    "normalized_file_name": "asset_899e72b2_duplicate_content.mp4",
    "compliance_status": "FAIL",
    "compliance_flags": [
      "Duration (6.00s) below minimum (10s)."
    ],
    "escalate_to_human": true
  },
  "normalized_file_path": "./ingest_processed/asset_899e72b2_duplicate_content.mp4",
  "escalate_to_human": true,
  "ingest_end_time": "2025-07-16T11:16:35.180453"
}
2025-07-16 11:16:35,183 - IngestAgent - DEBUG - Thought Chain: Hand-off completed successfully. Justification: Asset is compliant or issues were handled internally.
2025-07-16 11:16:35,184 - IngestAgent - INFO - Hand-off complete.
2025-07-16 11:16:35,184 - IngestAgent - INFO - --- Ingestion pipeline completed for: ./ingest_source/duplicate_content_video.mp4 ---
2025-07-16 11:16:35,185 - IngestAgent - DEBUG - Thought Chain: Pipeline completed successfully for ./ingest_source/duplicate_content_video.mp4.
2025-07-16 11:16:35,984 - IngestAgent - INFO - --- Starting ingestion pipeline for: ./ingest_source/another_copy_of_duplicate.mp4 ---
2025-07-16 11:16:35,984 - IngestAgent - DEBUG - Thought Chain: Pipeline started for ./ingest_source/another_copy_of_duplicate.mp4.
2025-07-16 11:16:35,985 - IngestAgent - DEBUG - Thought Chain: Loaded initial metadata from sidecar for override checks.
2025-07-16 11:16:35,988 - IngestAgent - DEBUG - Thought Chain: Executing Format Detection & Validation step.
2025-07-16 11:16:35,996 - IngestAgent - INFO - Starting format detection for: ./ingest_source/another_copy_of_duplicate.mp4
2025-07-16 11:16:35,996 - IngestAgent - DEBUG - Thought Chain: Initiating FFprobe simulation for ./ingest_source/another_copy_of_duplicate.mp4
2025-07-16 11:16:35,997 - IngestAgent - DEBUG - Simulated FFprobe for ./ingest_source/another_copy_of_duplicate.mp4: {'format': {'filename': 'another_copy_of_duplicate.mp4', 'nb_streams': 2, 'format_name': 'mp4', 'duration': 6.0, 'size': 10485760}, 'streams': [{'codec_type': 'video', 'codec_name': 'h264', 'width': 1920, 'height': 1080, 'avg_frame_rate': '25/1', 'display_aspect_ratio': '16:9'}, {'codec_type': 'audio', 'codec_name': 'aac', 'channels': 2}]}
2025-07-16 11:16:35,998 - IngestAgent - DEBUG - Thought Chain: File extension 'mp4' is allowed. Justification: Complies with 'allowed_formats' policy.
2025-07-16 11:16:35,999 - IngestAgent - DEBUG - Thought Chain: No operator override for transcode detected. Justification: Proceeding with standard transcode decision.
2025-07-16 11:16:35,999 - IngestAgent - INFO - Format validation successful for ./ingest_source/another_copy_of_duplicate.mp4.
2025-07-16 11:16:35,999 - IngestAgent - DEBUG - Thought Chain: Decision - Format is compliant. No transcode needed. Justification: All format policies passed.
2025-07-16 11:16:36,000 - IngestAgent - INFO - Format validation successful for ./ingest_source/another_copy_of_duplicate.mp4.
2025-07-16 11:16:36,001 - IngestAgent - DEBUG - Thought Chain: Executing Metadata Extraction & Enrichment step.
2025-07-16 11:16:36,002 - IngestAgent - INFO - Starting metadata extraction for: ./ingest_source/another_copy_of_duplicate.mp4
2025-07-16 11:16:36,002 - IngestAgent - DEBUG - Thought Chain: Initiating metadata extraction and enrichment for ./ingest_source/another_copy_of_duplicate.mp4
2025-07-16 11:16:36,361 - IngestAgent - DEBUG - Calculated sha256 checksum for ./ingest_source/another_copy_of_duplicate.mp4
2025-07-16 11:16:36,364 - IngestAgent - DEBUG - Thought Chain: Basic metadata extracted from file system and FFprobe data.
2025-07-16 11:16:36,365 - IngestAgent - INFO - Extracted metadata from sidecar: ./ingest_source/another_copy_of_duplicate.json
2025-07-16 11:16:36,366 - IngestAgent - DEBUG - Thought Chain: Sidecar JSON found and merged. Justification: External metadata source provided.
2025-07-16 11:16:36,366 - IngestAgent - DEBUG - Thought Chain: Title already present in metadata. Justification: Existing metadata takes precedence.
2025-07-16 11:16:36,366 - IngestAgent - DEBUG - Thought Chain: Determining asset type for another_copy_of_duplicate.mp4
2025-07-16 11:16:36,366 - IngestAgent - DEBUG - Thought Chain: Determined asset type: episode.
2025-07-16 11:16:36,368 - IngestAgent - INFO - Determined asset type: episode
2025-07-16 11:16:36,368 - IngestAgent - INFO - Performing real AI enrichment for asset type: episode
2025-07-16 11:16:36,369 - IngestAgent - DEBUG - Thought Chain: Starting AI enrichment. Initial metadata: Duplicate Content, type: episode
2025-07-16 11:16:36,369 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI summary based on prompt: 'Generate a very short, concise summary (max 2 sentences) for a media a...'
2025-07-16 11:16:36,369 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:37,336 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:37,337 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI summary. Justification: LLM provided concise overview based on title/genre.
2025-07-16 11:16:37,339 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI keywords based on prompt: 'Extract up to 5 keywords from the following media asset description: '...'
2025-07-16 11:16:37,339 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:39,660 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:39,661 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI keywords. Justification: LLM provided relevant keywords in expected format.
2025-07-16 11:16:39,662 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI mood based on prompt: 'Based on the genre 'Test' and summary 'This test media asset appears t...'
2025-07-16 11:16:39,662 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-16 11:16:40,715 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-16 11:16:40,717 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI mood. Justification: LLM provided a single-word mood based on context.
2025-07-16 11:16:40,718 - IngestAgent - DEBUG - Real AI enrichment complete. New metadata: {'source_file': 'another_copy_of_duplicate.mp4', 'ingest_timestamp': '2025-07-16T11:16:36.002501', 'checksum_sha256': 'eb6183addde05c2196ce25e6fa34a4baf20f9bf30d33892f452a9a1e88c9a472', 'file_size_bytes': 10485760, 'duration': 6.0, 'title': 'Duplicate Content', 'genre': 'Test', 'language': 'English', 'asset_type': 'episode', 'ai_summary': 'This test media asset appears to contain content that is repeated. Its purpose is likely related to testing systems or processes dealing with redundancy.\n', 'ai_keywords': ['Duplicate Content', 'repeated content', 'testing', 'redundancy', 'test media asset'], 'mood': 'neutral'}
2025-07-16 11:16:40,718 - IngestAgent - DEBUG - Thought Chain: AI enrichment process concluded.
2025-07-16 11:16:40,719 - IngestAgent - INFO - Metadata extraction and enrichment complete for ./ingest_source/another_copy_of_duplicate.mp4.
2025-07-16 11:16:40,719 - IngestAgent - DEBUG - Thought Chain: Metadata extraction and enrichment process concluded.
2025-07-16 11:16:40,719 - IngestAgent - DEBUG - Final metadata: {
  "source_file": "another_copy_of_duplicate.mp4",
  "ingest_timestamp": "2025-07-16T11:16:36.002501",
  "checksum_sha256": "eb6183addde05c2196ce25e6fa34a4baf20f9bf30d33892f452a9a1e88c9a472",
  "file_size_bytes": 10485760,
  "duration": 6.0,
  "title": "Duplicate Content",
  "genre": "Test",
  "language": "English",
  "asset_type": "episode",
  "ai_summary": "This test media asset appears to contain content that is repeated. Its purpose is likely related to testing systems or processes dealing with redundancy.\n",
  "ai_keywords": [
    "Duplicate Content",
    "repeated content",
    "testing",
    "redundancy",
    "test media asset"
  ],
  "mood": "neutral"
}
2025-07-16 11:16:40,721 - IngestAgent - DEBUG - Thought Chain: Executing Content Normalization step.
2025-07-16 11:16:40,721 - IngestAgent - INFO - Starting content normalization for: another_copy_of_duplicate.mp4
2025-07-16 11:16:40,721 - IngestAgent - DEBUG - Thought Chain: Initiating content normalization for another_copy_of_duplicate.mp4
2025-07-16 11:16:40,722 - IngestAgent - DEBUG - Thought Chain: Determined normalized name: asset_e8d0896b_duplicate_content.mp4. Justification: Standard naming convention applied.
2025-07-16 11:16:40,722 - IngestAgent - INFO - Skipping move for duplicate file another_copy_of_duplicate.mp4. Already processed content.
2025-07-16 11:16:40,722 - IngestAgent - DEBUG - Thought Chain: Not moving duplicate file. Justification: Content hash matches existing processed asset. Content already exists in normalized form.
2025-07-16 11:16:40,722 - IngestAgent - INFO - Content normalization complete for ./ingest_source/another_copy_of_duplicate.mp4.
2025-07-16 11:16:40,722 - IngestAgent - DEBUG - Thought Chain: Content normalization process concluded.
2025-07-16 11:16:40,723 - IngestAgent - INFO - Ingestion pipeline skipped for ./ingest_source/another_copy_of_duplicate.mp4: Duplicate content detected.
2025-07-16 11:16:40,723 - IngestAgent - DEBUG - Thought Chain: Decision - Pipeline terminated due to duplicate content. Justification: Asset content already exists in the system.
2025-07-16 11:16:40,723 - IngestAgent - INFO - Handing off asset to downstream agents: N/A
2025-07-16 11:16:40,723 - IngestAgent - DEBUG - Thought Chain: Initiating hand-off process.
2025-07-16 11:16:40,724 - IngestAgent - INFO - Context Shared (simulated hand-off):
{
  "original_path": "./ingest_source/another_copy_of_duplicate.mp4",
  "ingest_start_time": "2025-07-16T11:16:35.984520",
  "status": "DUPLICATE_SKIPPED",
  "format_valid": true,
  "format_issues": [],
  "transcode_needed": false,
  "initial_transcode_required": false,
  "ffprobe_data": {
    "format": {
      "filename": "another_copy_of_duplicate.mp4",
      "nb_streams": 2,
      "format_name": "mp4",
      "duration": 6.0,
      "size": 10485760
    },
    "streams": [
      {
        "codec_type": "video",
        "codec_name": "h264",
        "width": 1920,
        "height": 1080,
        "avg_frame_rate": "25/1",
        "display_aspect_ratio": "16:9"
      },
      {
        "codec_type": "audio",
        "codec_name": "aac",
        "channels": 2
      }
    ]
  },
  "metadata": {
    "source_file": "another_copy_of_duplicate.mp4",
    "ingest_timestamp": "2025-07-16T11:16:36.002501",
    "checksum_sha256": "eb6183addde05c2196ce25e6fa34a4baf20f9bf30d33892f452a9a1e88c9a472",
    "file_size_bytes": 10485760,
    "duration": 6.0,
    "title": "Duplicate Content",
    "genre": "Test",
    "language": "English",
    "asset_type": "episode",
    "ai_summary": "This test media asset appears to contain content that is repeated. Its purpose is likely related to testing systems or processes dealing with redundancy.\n",
    "ai_keywords": [
      "Duplicate Content",
      "repeated content",
      "testing",
      "redundancy",
      "test media asset"
    ],
    "mood": "neutral",
    "normalized_file_path": "DUPLICATE_SKIPPED_MOVE",
    "normalized_file_name": "DUPLICATE_SKIPPED_MOVE"
  }
}
2025-07-16 11:16:40,724 - IngestAgent - DEBUG - Thought Chain: Hand-off completed successfully. Justification: Asset is compliant or issues were handled internally.
2025-07-16 11:16:40,724 - IngestAgent - INFO - Hand-off complete.
