2025-07-15 12:40:12,654 - IngestAgent - INFO - Ensured watch folder exists: ./ingest_source
2025-07-15 12:40:12,655 - IngestAgent - INFO - Ensured output folder exists: ./ingest_processed
2025-07-15 12:40:12,655 - IngestAgent - INFO - Ingest Agent initialized.
2025-07-15 12:40:12,655 - IngestAgent - DEBUG - Configuration loaded: {
  "watch_folders": [
    "./ingest_source"
  ],
  "output_folder": "./ingest_processed",
  "policies": {
    "min_duration_seconds": 10,
    "max_duration_seconds": 3600,
    "allowed_formats": [
      "mp4",
      "mov",
      "mxf"
    ],
    "required_metadata_fields": [
      "title",
      "genre",
      "language"
    ],
    "ad_duration_limit_seconds": 60,
    "max_file_size_mb": 40960
  },
  "log_level": "DEBUG",
  "log_file": "ingest_agent.log"
}
2025-07-15 12:40:12,655 - IngestAgent - INFO - Ingest Agent instance fully initialized and ready with OpenTelemetry tracer.
2025-07-15 12:40:14,671 - IngestAgent - INFO - --- Starting ingestion pipeline for: ./ingest_source/my_episode_s01e01.mp4 ---
2025-07-15 12:40:14,671 - IngestAgent - DEBUG - Thought Chain: Pipeline started for ./ingest_source/my_episode_s01e01.mp4.
2025-07-15 12:40:14,672 - IngestAgent - DEBUG - Thought Chain: Loaded initial metadata from sidecar for override checks.
2025-07-15 12:40:14,683 - IngestAgent - DEBUG - Thought Chain: Executing Format Detection & Validation step.
2025-07-15 12:40:14,684 - IngestAgent - INFO - Starting format detection for: ./ingest_source/my_episode_s01e01.mp4
2025-07-15 12:40:14,684 - IngestAgent - DEBUG - Thought Chain: Initiating FFprobe simulation for ./ingest_source/my_episode_s01e01.mp4
2025-07-15 12:40:14,684 - IngestAgent - DEBUG - Simulated FFprobe for ./ingest_source/my_episode_s01e01.mp4: {'format': {'filename': 'my_episode_s01e01.mp4', 'nb_streams': 2, 'format_name': 'mp4', 'duration': 12.0, 'size': 20971520}, 'streams': [{'codec_type': 'video', 'codec_name': 'h264', 'width': 1920, 'height': 1080, 'avg_frame_rate': '25/1', 'display_aspect_ratio': '16:9'}, {'codec_type': 'audio', 'codec_name': 'aac', 'channels': 2}]}
2025-07-15 12:40:14,728 - IngestAgent - DEBUG - Thought Chain: File extension 'mp4' is allowed. Justification: Complies with 'allowed_formats' policy.
2025-07-15 12:40:14,728 - IngestAgent - DEBUG - Thought Chain: No operator override for transcode detected. Justification: Proceeding with standard transcode decision.
2025-07-15 12:40:14,728 - IngestAgent - INFO - Format validation successful for ./ingest_source/my_episode_s01e01.mp4.
2025-07-15 12:40:14,728 - IngestAgent - DEBUG - Thought Chain: Decision - Format is compliant. No transcode needed. Justification: All format policies passed.
2025-07-15 12:40:14,730 - IngestAgent - INFO - Format validation successful for ./ingest_source/my_episode_s01e01.mp4.
2025-07-15 12:40:14,731 - IngestAgent - DEBUG - Thought Chain: Executing Metadata Extraction & Enrichment step.
2025-07-15 12:40:14,731 - IngestAgent - INFO - Starting metadata extraction for: ./ingest_source/my_episode_s01e01.mp4
2025-07-15 12:40:14,731 - IngestAgent - DEBUG - Thought Chain: Initiating metadata extraction and enrichment for ./ingest_source/my_episode_s01e01.mp4
2025-07-15 12:40:15,454 - IngestAgent - DEBUG - Calculated sha256 checksum for ./ingest_source/my_episode_s01e01.mp4
2025-07-15 12:40:15,456 - IngestAgent - DEBUG - Thought Chain: Basic metadata extracted from file system and FFprobe data.
2025-07-15 12:40:15,457 - IngestAgent - INFO - Extracted metadata from sidecar: ./ingest_source/my_episode_s01e01.json
2025-07-15 12:40:15,458 - IngestAgent - DEBUG - Thought Chain: Sidecar JSON found and merged. Justification: External metadata source provided.
2025-07-15 12:40:15,459 - IngestAgent - DEBUG - Thought Chain: Title already present in metadata. Justification: Existing metadata takes precedence.
2025-07-15 12:40:15,459 - IngestAgent - DEBUG - Thought Chain: Determining asset type for my_episode_s01e01.mp4
2025-07-15 12:40:15,459 - IngestAgent - DEBUG - Thought Chain: Determined asset type: episode.
2025-07-15 12:40:15,460 - IngestAgent - INFO - Determined asset type: episode
2025-07-15 12:40:15,461 - IngestAgent - INFO - Performing real AI enrichment for asset type: episode
2025-07-15 12:40:15,461 - IngestAgent - DEBUG - Thought Chain: Starting AI enrichment. Initial metadata: My First Episode, type: episode
2025-07-15 12:40:15,461 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI summary based on prompt: 'Generate a very short, concise summary (max 2 sentences) for a media a...'
2025-07-15 12:40:15,461 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:18,321 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:18,323 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI summary. Justification: LLM provided concise overview based on title/genre.
2025-07-15 12:40:18,325 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI keywords based on prompt: 'Extract up to 5 keywords from the following media asset description: '...'
2025-07-15 12:40:18,326 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:20,453 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:20,454 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI keywords. Justification: LLM provided relevant keywords in expected format.
2025-07-15 12:40:20,456 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI mood based on prompt: 'Based on the genre 'Sci-Fi' and summary 'A character navigates a futur...'
2025-07-15 12:40:20,456 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:22,500 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:22,502 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI mood. Justification: LLM provided a single-word mood based on context.
2025-07-15 12:40:22,503 - IngestAgent - DEBUG - Real AI enrichment complete. New metadata: {'source_file': 'my_episode_s01e01.mp4', 'ingest_timestamp': '2025-07-15T12:40:14.731977', 'checksum_sha256': '3e872f2c5008f32b024a9cb02112280e7ef9e2f1bb54a417f685dd96537fa504', 'file_size_bytes': 20971520, 'duration': 12.0, 'title': 'My First Episode', 'genre': 'Sci-Fi', 'language': 'English', 'ei_rating': 'E', 'asset_type': 'episode', 'ai_summary': 'A character navigates a futuristic, sterile environment. This introductory episode establishes a world with advanced technology.\n', 'ai_keywords': ['futuristic', 'sterile environment', 'advanced technology', 'character', 'episode'], 'mood': 'serious'}
2025-07-15 12:40:22,503 - IngestAgent - DEBUG - Thought Chain: AI enrichment process concluded.
2025-07-15 12:40:22,504 - IngestAgent - INFO - Metadata extraction and enrichment complete for ./ingest_source/my_episode_s01e01.mp4.
2025-07-15 12:40:22,504 - IngestAgent - DEBUG - Thought Chain: Metadata extraction and enrichment process concluded.
2025-07-15 12:40:22,504 - IngestAgent - DEBUG - Final metadata: {
  "source_file": "my_episode_s01e01.mp4",
  "ingest_timestamp": "2025-07-15T12:40:14.731977",
  "checksum_sha256": "3e872f2c5008f32b024a9cb02112280e7ef9e2f1bb54a417f685dd96537fa504",
  "file_size_bytes": 20971520,
  "duration": 12.0,
  "title": "My First Episode",
  "genre": "Sci-Fi",
  "language": "English",
  "ei_rating": "E",
  "asset_type": "episode",
  "ai_summary": "A character navigates a futuristic, sterile environment. This introductory episode establishes a world with advanced technology.\n",
  "ai_keywords": [
    "futuristic",
    "sterile environment",
    "advanced technology",
    "character",
    "episode"
  ],
  "mood": "serious"
}
2025-07-15 12:40:22,505 - IngestAgent - DEBUG - Thought Chain: Executing Content Normalization step.
2025-07-15 12:40:22,505 - IngestAgent - INFO - Starting content normalization for: my_episode_s01e01.mp4
2025-07-15 12:40:22,506 - IngestAgent - DEBUG - Thought Chain: Initiating content normalization for my_episode_s01e01.mp4
2025-07-15 12:40:22,521 - IngestAgent - DEBUG - Thought Chain: Determined normalized name: asset_b3d3b477_my_first_episode.mp4. Justification: Standard naming convention applied.
2025-07-15 12:40:22,522 - IngestAgent - INFO - Normalized and moved my_episode_s01e01.mp4 to ./ingest_processed/asset_b3d3b477_my_first_episode.mp4
2025-07-15 12:40:22,523 - IngestAgent - DEBUG - Thought Chain: File successfully moved to normalized path. Justification: Unique content, moved to standard location. Adding checksum to processed set.
2025-07-15 12:40:22,523 - IngestAgent - INFO - Content normalization complete for ./ingest_source/my_episode_s01e01.mp4.
2025-07-15 12:40:22,523 - IngestAgent - DEBUG - Thought Chain: Content normalization process concluded.
2025-07-15 12:40:22,524 - IngestAgent - DEBUG - Thought Chain: Executing Policy Compliance Check step.
2025-07-15 12:40:22,568 - IngestAgent - INFO - Starting policy compliance check for asset: My First Episode
2025-07-15 12:40:22,568 - IngestAgent - DEBUG - Thought Chain: Initiating policy compliance check.
2025-07-15 12:40:22,568 - IngestAgent - DEBUG - Thought Chain: Required field 'title' is present. Justification: Metadata completeness criteria met for this field.
2025-07-15 12:40:22,568 - IngestAgent - DEBUG - Thought Chain: Required field 'genre' is present. Justification: Metadata completeness criteria met for this field.
2025-07-15 12:40:22,568 - IngestAgent - DEBUG - Thought Chain: Required field 'language' is present. Justification: Metadata completeness criteria met for this field.
2025-07-15 12:40:22,568 - IngestAgent - DEBUG - Thought Chain: Checking duration policy. Duration: 12.00s, Asset Type: episode
2025-07-15 12:40:22,569 - IngestAgent - DEBUG - Thought Chain: Checking file size policy. Size: 20.00 MB, Max: 40960 MB.
2025-07-15 12:40:22,569 - IngestAgent - DEBUG - Thought Chain: File size is within allowed limits. Justification: Complies with file size policy.
2025-07-15 12:40:22,571 - IngestAgent - DEBUG - Thought Chain: Checking E/I rating for kids content.
2025-07-15 12:40:22,571 - IngestAgent - INFO - Policy compliance check passed for My First Episode.
2025-07-15 12:40:22,571 - IngestAgent - DEBUG - Thought Chain: Decision - Policy compliance passed. Status: PASS. Justification: All policy checks passed without flags.
2025-07-15 12:40:22,572 - IngestAgent - DEBUG - Thought Chain: Policy compliance check concluded.
2025-07-15 12:40:22,572 - IngestAgent - DEBUG - Thought Chain: Executing Event-Driven Hand-off step.
2025-07-15 12:40:22,573 - IngestAgent - INFO - Handing off asset to downstream agents: N/A
2025-07-15 12:40:22,573 - IngestAgent - DEBUG - Thought Chain: Initiating hand-off process.
2025-07-15 12:40:22,573 - IngestAgent - INFO - Context Shared (simulated hand-off):
{
  "original_path": "./ingest_source/my_episode_s01e01.mp4",
  "ingest_start_time": "2025-07-15T12:40:14.670864",
  "status": "COMPLETED",
  "format_valid": true,
  "format_issues": [],
  "transcode_needed": false,
  "initial_transcode_required": false,
  "ffprobe_data": {
    "format": {
      "filename": "my_episode_s01e01.mp4",
      "nb_streams": 2,
      "format_name": "mp4",
      "duration": 12.0,
      "size": 20971520
    },
    "streams": [
      {
        "codec_type": "video",
        "codec_name": "h264",
        "width": 1920,
        "height": 1080,
        "avg_frame_rate": "25/1",
        "display_aspect_ratio": "16:9"
      },
      {
        "codec_type": "audio",
        "codec_name": "aac",
        "channels": 2
      }
    ]
  },
  "metadata": {
    "source_file": "my_episode_s01e01.mp4",
    "ingest_timestamp": "2025-07-15T12:40:14.731977",
    "checksum_sha256": "3e872f2c5008f32b024a9cb02112280e7ef9e2f1bb54a417f685dd96537fa504",
    "file_size_bytes": 20971520,
    "duration": 12.0,
    "title": "My First Episode",
    "genre": "Sci-Fi",
    "language": "English",
    "ei_rating": "E",
    "asset_type": "episode",
    "ai_summary": "A character navigates a futuristic, sterile environment. This introductory episode establishes a world with advanced technology.\n",
    "ai_keywords": [
      "futuristic",
      "sterile environment",
      "advanced technology",
      "character",
      "episode"
    ],
    "mood": "serious",
    "normalized_file_path": "./ingest_processed/asset_b3d3b477_my_first_episode.mp4",
    "normalized_file_name": "asset_b3d3b477_my_first_episode.mp4",
    "compliance_status": "PASS",
    "compliance_flags": [],
    "escalate_to_human": false
  },
  "normalized_file_path": "./ingest_processed/asset_b3d3b477_my_first_episode.mp4",
  "ingest_end_time": "2025-07-15T12:40:22.572825"
}
2025-07-15 12:40:22,577 - IngestAgent - DEBUG - Thought Chain: Hand-off completed successfully. Justification: Asset is compliant or issues were handled internally.
2025-07-15 12:40:22,578 - IngestAgent - INFO - Hand-off complete.
2025-07-15 12:40:22,580 - IngestAgent - INFO - --- Ingestion pipeline completed for: ./ingest_source/my_episode_s01e01.mp4 ---
2025-07-15 12:40:22,580 - IngestAgent - DEBUG - Thought Chain: Pipeline completed successfully for ./ingest_source/my_episode_s01e01.mp4.
2025-07-15 12:40:23,352 - IngestAgent - INFO - --- Starting ingestion pipeline for: ./ingest_source/bad_format_video.avi ---
2025-07-15 12:40:23,352 - IngestAgent - DEBUG - Thought Chain: Pipeline started for ./ingest_source/bad_format_video.avi.
2025-07-15 12:40:23,353 - IngestAgent - INFO - No initial sidecar JSON found for ./ingest_source/bad_format_video.avi.
2025-07-15 12:40:23,354 - IngestAgent - DEBUG - Thought Chain: Executing Format Detection & Validation step.
2025-07-15 12:40:23,369 - IngestAgent - INFO - Starting format detection for: ./ingest_source/bad_format_video.avi
2025-07-15 12:40:23,369 - IngestAgent - DEBUG - Thought Chain: Initiating FFprobe simulation for ./ingest_source/bad_format_video.avi
2025-07-15 12:40:23,370 - IngestAgent - DEBUG - Simulated FFprobe for ./ingest_source/bad_format_video.avi: {'format': {'filename': 'bad_format_video.avi', 'nb_streams': 2, 'format_name': 'avi', 'duration': 0.6, 'size': 1048576}, 'streams': [{'codec_type': 'video', 'codec_name': 'mpeg2video', 'width': 1920, 'height': 1080, 'avg_frame_rate': '25/1', 'display_aspect_ratio': '16:9'}, {'codec_type': 'audio', 'codec_name': 'mp3', 'channels': 2}]}
2025-07-15 12:40:23,377 - IngestAgent - DEBUG - Thought Chain: Format 'avi' is not allowed. Justification: Policy 'allowed_formats' violated. Flagging for transcode.
2025-07-15 12:40:23,377 - IngestAgent - DEBUG - Thought Chain: Video codec 'mpeg2video' is unsupported. Justification: Policy violation. Flagging for transcode.
2025-07-15 12:40:23,378 - IngestAgent - DEBUG - Thought Chain: Audio codec 'mp3' is unsupported. Justification: Policy violation. Flagging for transcode.
2025-07-15 12:40:23,378 - IngestAgent - DEBUG - Thought Chain: No operator override for transcode detected. Justification: Proceeding with standard transcode decision.
2025-07-15 12:40:23,378 - IngestAgent - WARNING - Format non-compliant for ./ingest_source/bad_format_video.avi. Transcode job triggered (simulated). Issues: ['Unsupported file format: avi. Allowed: mp4, mov, mxf', 'Unsupported video codec: mpeg2video.', 'Unsupported audio codec: mp3.']
2025-07-15 12:40:23,378 - IngestAgent - DEBUG - Thought Chain: Decision - Transcode needed due to format issues. Justification: Format issues detected and no override present.
2025-07-15 12:40:23,379 - IngestAgent - INFO - Ingestion for ./ingest_source/bad_format_video.avi completed, but transcode is needed.
2025-07-15 12:40:23,379 - IngestAgent - DEBUG - Thought Chain: Executing Metadata Extraction & Enrichment step.
2025-07-15 12:40:23,380 - IngestAgent - INFO - Starting metadata extraction for: ./ingest_source/bad_format_video.avi
2025-07-15 12:40:23,380 - IngestAgent - DEBUG - Thought Chain: Initiating metadata extraction and enrichment for ./ingest_source/bad_format_video.avi
2025-07-15 12:40:23,522 - IngestAgent - DEBUG - Calculated sha256 checksum for ./ingest_source/bad_format_video.avi
2025-07-15 12:40:23,523 - IngestAgent - DEBUG - Thought Chain: Basic metadata extracted from file system and FFprobe data.
2025-07-15 12:40:23,523 - IngestAgent - INFO - No sidecar JSON found for ./ingest_source/bad_format_video.avi.
2025-07-15 12:40:23,523 - IngestAgent - DEBUG - Thought Chain: No sidecar JSON found. Justification: No external metadata provided. Proceeding without it.
2025-07-15 12:40:23,523 - IngestAgent - DEBUG - Thought Chain: Title not found. Justification: Inferred from filename as per policy.
2025-07-15 12:40:23,524 - IngestAgent - DEBUG - Thought Chain: Determining asset type for bad_format_video.avi
2025-07-15 12:40:23,525 - IngestAgent - DEBUG - Thought Chain: Identified as 'ad' based on filename heuristic.
2025-07-15 12:40:23,525 - IngestAgent - DEBUG - Thought Chain: Determined asset type: ad.
2025-07-15 12:40:23,525 - IngestAgent - INFO - Determined asset type: ad
2025-07-15 12:40:23,526 - IngestAgent - INFO - Performing real AI enrichment for asset type: ad
2025-07-15 12:40:23,526 - IngestAgent - DEBUG - Thought Chain: Starting AI enrichment. Initial metadata: Bad Format Video, type: ad
2025-07-15 12:40:23,526 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI summary based on prompt: 'Generate a very short, concise summary (max 2 sentences) for a media a...'
2025-07-15 12:40:23,526 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:24,957 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:24,959 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI summary. Justification: LLM provided concise overview based on title/genre.
2025-07-15 12:40:24,960 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI keywords based on prompt: 'Extract up to 5 keywords from the following media asset description: '...'
2025-07-15 12:40:24,960 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:27,824 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:27,827 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI keywords. Justification: LLM provided relevant keywords in expected format.
2025-07-15 12:40:27,828 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI mood based on prompt: 'Based on the genre 'N/A' and summary 'The media asset, titled "Bad For...'
2025-07-15 12:40:27,828 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:28,794 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:28,795 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI mood. Justification: LLM provided a single-word mood based on context.
2025-07-15 12:40:28,795 - IngestAgent - DEBUG - Real AI enrichment complete. New metadata: {'source_file': 'bad_format_video.avi', 'ingest_timestamp': '2025-07-15T12:40:23.380706', 'checksum_sha256': '4e29ad18ab9f42d7c233500771a39d7c852b200baf328fd00fbbe3fecea1eb56', 'file_size_bytes': 1048576, 'duration': 0.6, 'title': 'Bad Format Video', 'asset_type': 'ad', 'ai_summary': 'The media asset, titled "Bad Format Video," appears to be a video. Its genre is unspecified.\n', 'ai_keywords': ['Video', 'media asset', 'Bad Format Video'], 'mood': 'neutral'}
2025-07-15 12:40:28,795 - IngestAgent - DEBUG - Thought Chain: AI enrichment process concluded.
2025-07-15 12:40:28,796 - IngestAgent - INFO - Metadata extraction and enrichment complete for ./ingest_source/bad_format_video.avi.
2025-07-15 12:40:28,796 - IngestAgent - DEBUG - Thought Chain: Metadata extraction and enrichment process concluded.
2025-07-15 12:40:28,796 - IngestAgent - DEBUG - Final metadata: {
  "source_file": "bad_format_video.avi",
  "ingest_timestamp": "2025-07-15T12:40:23.380706",
  "checksum_sha256": "4e29ad18ab9f42d7c233500771a39d7c852b200baf328fd00fbbe3fecea1eb56",
  "file_size_bytes": 1048576,
  "duration": 0.6,
  "title": "Bad Format Video",
  "asset_type": "ad",
  "ai_summary": "The media asset, titled \"Bad Format Video,\" appears to be a video. Its genre is unspecified.\n",
  "ai_keywords": [
    "Video",
    "media asset",
    "Bad Format Video"
  ],
  "mood": "neutral"
}
2025-07-15 12:40:28,797 - IngestAgent - DEBUG - Thought Chain: Executing Content Normalization step.
2025-07-15 12:40:28,797 - IngestAgent - INFO - Starting content normalization for: bad_format_video.avi
2025-07-15 12:40:28,797 - IngestAgent - DEBUG - Thought Chain: Initiating content normalization for bad_format_video.avi
2025-07-15 12:40:28,797 - IngestAgent - DEBUG - Thought Chain: Determined normalized name: asset_65da0c1c_bad_format_video.avi. Justification: Standard naming convention applied.
2025-07-15 12:40:28,797 - IngestAgent - INFO - Normalized and moved bad_format_video.avi to ./ingest_processed/asset_65da0c1c_bad_format_video.avi
2025-07-15 12:40:28,798 - IngestAgent - DEBUG - Thought Chain: File successfully moved to normalized path. Justification: Unique content, moved to standard location. Adding checksum to processed set.
2025-07-15 12:40:28,798 - IngestAgent - INFO - Content normalization complete for ./ingest_source/bad_format_video.avi.
2025-07-15 12:40:28,798 - IngestAgent - DEBUG - Thought Chain: Content normalization process concluded.
2025-07-15 12:40:28,798 - IngestAgent - DEBUG - Thought Chain: Executing Policy Compliance Check step.
2025-07-15 12:40:28,798 - IngestAgent - INFO - Starting policy compliance check for asset: Bad Format Video
2025-07-15 12:40:28,802 - IngestAgent - DEBUG - Thought Chain: Initiating policy compliance check.
2025-07-15 12:40:28,802 - IngestAgent - DEBUG - Thought Chain: Required field 'title' is present. Justification: Metadata completeness criteria met for this field.
2025-07-15 12:40:28,802 - IngestAgent - DEBUG - Thought Chain: Missing required field 'genre'. Justification: Policy 'required_metadata_fields' violated. Escalation triggered.
2025-07-15 12:40:28,802 - IngestAgent - DEBUG - Thought Chain: Missing required field 'language'. Justification: Policy 'required_metadata_fields' violated. Escalation triggered.
2025-07-15 12:40:28,803 - IngestAgent - DEBUG - Thought Chain: Checking duration policy. Duration: 0.60s, Asset Type: ad
2025-07-15 12:40:28,803 - IngestAgent - DEBUG - Thought Chain: Checking file size policy. Size: 1.00 MB, Max: 40960 MB.
2025-07-15 12:40:28,803 - IngestAgent - DEBUG - Thought Chain: File size is within allowed limits. Justification: Complies with file size policy.
2025-07-15 12:40:28,803 - IngestAgent - DEBUG - Thought Chain: Checking E/I rating for kids content.
2025-07-15 12:40:28,803 - IngestAgent - WARNING - Policy compliance issues for Bad Format Video. Flags: ['Missing required metadata field: genre.', 'Missing required metadata field: language.']
2025-07-15 12:40:28,803 - IngestAgent - DEBUG - Thought Chain: Decision - Policy compliance failed. Status: FAIL. Justification: One or more policy flags were set.
2025-07-15 12:40:28,804 - IngestAgent - ERROR - Escalating asset Bad Format Video to human for review.
2025-07-15 12:40:28,804 - IngestAgent - DEBUG - Thought Chain: Decision - Escalating to human due to critical policy breach. Justification: Escalation flag set by policy check.
2025-07-15 12:40:28,804 - IngestAgent - DEBUG - Thought Chain: Policy compliance check concluded.
2025-07-15 12:40:28,821 - IngestAgent - CRITICAL - Unhandled error in ingestion pipeline for ./ingest_source/bad_format_video.avi: 'compliance_flags'
Traceback (most recent call last):
  File "/Users/admin/PycharmProjects/IngestAgent/ingest_agent.py", line 1065, in ingest_asset_pipeline
    processed_asset_info["compliance_flags"].extend(compliance_flags)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
KeyError: 'compliance_flags'
2025-07-15 12:40:28,826 - IngestAgent - INFO - Handing off asset to downstream agents: N/A
2025-07-15 12:40:28,826 - IngestAgent - DEBUG - Thought Chain: Initiating hand-off process.
2025-07-15 12:40:28,826 - IngestAgent - INFO - Context Shared (simulated hand-off):
{
  "original_path": "./ingest_source/bad_format_video.avi",
  "ingest_start_time": "2025-07-15T12:40:23.352369",
  "status": "CRITICAL_FAILURE",
  "format_valid": false,
  "format_issues": [
    "Unsupported file format: avi. Allowed: mp4, mov, mxf",
    "Unsupported video codec: mpeg2video.",
    "Unsupported audio codec: mp3."
  ],
  "transcode_needed": true,
  "initial_transcode_required": true,
  "ffprobe_data": {
    "format": {
      "filename": "bad_format_video.avi",
      "nb_streams": 2,
      "format_name": "avi",
      "duration": 0.6,
      "size": 1048576
    },
    "streams": [
      {
        "codec_type": "video",
        "codec_name": "mpeg2video",
        "width": 1920,
        "height": 1080,
        "avg_frame_rate": "25/1",
        "display_aspect_ratio": "16:9"
      },
      {
        "codec_type": "audio",
        "codec_name": "mp3",
        "channels": 2
      }
    ]
  },
  "metadata": {
    "source_file": "bad_format_video.avi",
    "ingest_timestamp": "2025-07-15T12:40:23.380706",
    "checksum_sha256": "4e29ad18ab9f42d7c233500771a39d7c852b200baf328fd00fbbe3fecea1eb56",
    "file_size_bytes": 1048576,
    "duration": 0.6,
    "title": "Bad Format Video",
    "asset_type": "ad",
    "ai_summary": "The media asset, titled \"Bad Format Video,\" appears to be a video. Its genre is unspecified.\n",
    "ai_keywords": [
      "Video",
      "media asset",
      "Bad Format Video"
    ],
    "mood": "neutral",
    "normalized_file_path": "./ingest_processed/asset_65da0c1c_bad_format_video.avi",
    "normalized_file_name": "asset_65da0c1c_bad_format_video.avi",
    "compliance_status": "FAIL",
    "compliance_flags": [
      "Missing required metadata field: genre.",
      "Missing required metadata field: language."
    ],
    "escalate_to_human": true
  },
  "normalized_file_path": "./ingest_processed/asset_65da0c1c_bad_format_video.avi",
  "error_message": "'compliance_flags'",
  "ingest_end_time": "2025-07-15T12:40:28.822892"
}
2025-07-15 12:40:28,828 - IngestAgent - DEBUG - Thought Chain: Hand-off completed successfully. Justification: Asset is compliant or issues were handled internally.
2025-07-15 12:40:28,828 - IngestAgent - INFO - Hand-off complete.
2025-07-15 12:40:29,335 - IngestAgent - INFO - --- Starting ingestion pipeline for: ./ingest_source/long_ad_campaign_x.mp4 ---
2025-07-15 12:40:29,335 - IngestAgent - DEBUG - Thought Chain: Pipeline started for ./ingest_source/long_ad_campaign_x.mp4.
2025-07-15 12:40:29,336 - IngestAgent - DEBUG - Thought Chain: Loaded initial metadata from sidecar for override checks.
2025-07-15 12:40:29,337 - IngestAgent - DEBUG - Thought Chain: Executing Format Detection & Validation step.
2025-07-15 12:40:29,338 - IngestAgent - INFO - Starting format detection for: ./ingest_source/long_ad_campaign_x.mp4
2025-07-15 12:40:29,338 - IngestAgent - DEBUG - Thought Chain: Initiating FFprobe simulation for ./ingest_source/long_ad_campaign_x.mp4
2025-07-15 12:40:29,339 - IngestAgent - DEBUG - Simulated FFprobe for ./ingest_source/long_ad_campaign_x.mp4: {'format': {'filename': 'long_ad_campaign_x.mp4', 'nb_streams': 2, 'format_name': 'mp4', 'duration': 60.6, 'size': 105906176}, 'streams': [{'codec_type': 'video', 'codec_name': 'h264', 'width': 1920, 'height': 1080, 'avg_frame_rate': '25/1', 'display_aspect_ratio': '16:9'}, {'codec_type': 'audio', 'codec_name': 'aac', 'channels': 2}]}
2025-07-15 12:40:29,340 - IngestAgent - DEBUG - Thought Chain: File extension 'mp4' is allowed. Justification: Complies with 'allowed_formats' policy.
2025-07-15 12:40:29,341 - IngestAgent - DEBUG - Thought Chain: No operator override for transcode detected. Justification: Proceeding with standard transcode decision.
2025-07-15 12:40:29,341 - IngestAgent - INFO - Format validation successful for ./ingest_source/long_ad_campaign_x.mp4.
2025-07-15 12:40:29,341 - IngestAgent - DEBUG - Thought Chain: Decision - Format is compliant. No transcode needed. Justification: All format policies passed.
2025-07-15 12:40:29,343 - IngestAgent - INFO - Format validation successful for ./ingest_source/long_ad_campaign_x.mp4.
2025-07-15 12:40:29,343 - IngestAgent - DEBUG - Thought Chain: Executing Metadata Extraction & Enrichment step.
2025-07-15 12:40:29,343 - IngestAgent - INFO - Starting metadata extraction for: ./ingest_source/long_ad_campaign_x.mp4
2025-07-15 12:40:29,343 - IngestAgent - DEBUG - Thought Chain: Initiating metadata extraction and enrichment for ./ingest_source/long_ad_campaign_x.mp4
2025-07-15 12:40:29,955 - IngestAgent - DEBUG - Calculated sha256 checksum for ./ingest_source/long_ad_campaign_x.mp4
2025-07-15 12:40:29,955 - IngestAgent - DEBUG - Thought Chain: Basic metadata extracted from file system and FFprobe data.
2025-07-15 12:40:29,956 - IngestAgent - INFO - Extracted metadata from sidecar: ./ingest_source/long_ad_campaign_x.json
2025-07-15 12:40:29,956 - IngestAgent - DEBUG - Thought Chain: Sidecar JSON found and merged. Justification: External metadata source provided.
2025-07-15 12:40:29,957 - IngestAgent - DEBUG - Thought Chain: Title already present in metadata. Justification: Existing metadata takes precedence.
2025-07-15 12:40:29,957 - IngestAgent - DEBUG - Thought Chain: Determining asset type for long_ad_campaign_x.mp4
2025-07-15 12:40:29,958 - IngestAgent - DEBUG - Thought Chain: Identified as 'ad' based on filename heuristic.
2025-07-15 12:40:29,958 - IngestAgent - DEBUG - Thought Chain: Determined asset type: ad.
2025-07-15 12:40:29,959 - IngestAgent - INFO - Determined asset type: ad
2025-07-15 12:40:29,959 - IngestAgent - INFO - Performing real AI enrichment for asset type: ad
2025-07-15 12:40:29,959 - IngestAgent - DEBUG - Thought Chain: Starting AI enrichment. Initial metadata: Long Ad Campaign X, type: ad
2025-07-15 12:40:29,960 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI summary based on prompt: 'Generate a very short, concise summary (max 2 sentences) for a media a...'
2025-07-15 12:40:29,960 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:32,329 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:32,330 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI summary. Justification: LLM provided concise overview based on title/genre.
2025-07-15 12:40:32,331 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI keywords based on prompt: 'Extract up to 5 keywords from the following media asset description: '...'
2025-07-15 12:40:32,332 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:34,603 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:34,604 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI keywords. Justification: LLM provided relevant keywords in expected format.
2025-07-15 12:40:34,605 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI mood based on prompt: 'Based on the genre 'Commercial' and summary '"Long Ad Campaign X" feat...'
2025-07-15 12:40:34,606 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:36,677 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:36,677 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI mood. Justification: LLM provided a single-word mood based on context.
2025-07-15 12:40:36,678 - IngestAgent - DEBUG - Real AI enrichment complete. New metadata: {'source_file': 'long_ad_campaign_x.mp4', 'ingest_timestamp': '2025-07-15T12:40:29.343815', 'checksum_sha256': '3c195a0507198c7574551ae014247153b20bac784cf0a5c3b1fa5038c2900093', 'file_size_bytes': 105906176, 'duration': 60.6, 'title': 'Long Ad Campaign X', 'genre': 'Commercial', 'language': 'English', 'asset_type': 'ad', 'ai_summary': '"Long Ad Campaign X" features various scenes of people using a product in everyday settings. The commercial includes bright visuals and upbeat music.\n', 'ai_keywords': ['product', 'everyday settings', 'bright visuals', 'upbeat music', 'commercial'], 'mood': 'upbeat'}
2025-07-15 12:40:36,678 - IngestAgent - DEBUG - Thought Chain: AI enrichment process concluded.
2025-07-15 12:40:36,680 - IngestAgent - INFO - Metadata extraction and enrichment complete for ./ingest_source/long_ad_campaign_x.mp4.
2025-07-15 12:40:36,680 - IngestAgent - DEBUG - Thought Chain: Metadata extraction and enrichment process concluded.
2025-07-15 12:40:36,680 - IngestAgent - DEBUG - Final metadata: {
  "source_file": "long_ad_campaign_x.mp4",
  "ingest_timestamp": "2025-07-15T12:40:29.343815",
  "checksum_sha256": "3c195a0507198c7574551ae014247153b20bac784cf0a5c3b1fa5038c2900093",
  "file_size_bytes": 105906176,
  "duration": 60.6,
  "title": "Long Ad Campaign X",
  "genre": "Commercial",
  "language": "English",
  "asset_type": "ad",
  "ai_summary": "\"Long Ad Campaign X\" features various scenes of people using a product in everyday settings. The commercial includes bright visuals and upbeat music.\n",
  "ai_keywords": [
    "product",
    "everyday settings",
    "bright visuals",
    "upbeat music",
    "commercial"
  ],
  "mood": "upbeat"
}
2025-07-15 12:40:36,681 - IngestAgent - DEBUG - Thought Chain: Executing Content Normalization step.
2025-07-15 12:40:36,681 - IngestAgent - INFO - Starting content normalization for: long_ad_campaign_x.mp4
2025-07-15 12:40:36,682 - IngestAgent - DEBUG - Thought Chain: Initiating content normalization for long_ad_campaign_x.mp4
2025-07-15 12:40:36,682 - IngestAgent - DEBUG - Thought Chain: Determined normalized name: asset_b1e2f6ec_long_ad_campaign_x.mp4. Justification: Standard naming convention applied.
2025-07-15 12:40:36,682 - IngestAgent - INFO - Normalized and moved long_ad_campaign_x.mp4 to ./ingest_processed/asset_b1e2f6ec_long_ad_campaign_x.mp4
2025-07-15 12:40:36,682 - IngestAgent - DEBUG - Thought Chain: File successfully moved to normalized path. Justification: Unique content, moved to standard location. Adding checksum to processed set.
2025-07-15 12:40:36,682 - IngestAgent - INFO - Content normalization complete for ./ingest_source/long_ad_campaign_x.mp4.
2025-07-15 12:40:36,683 - IngestAgent - DEBUG - Thought Chain: Content normalization process concluded.
2025-07-15 12:40:36,684 - IngestAgent - DEBUG - Thought Chain: Executing Policy Compliance Check step.
2025-07-15 12:40:36,684 - IngestAgent - INFO - Starting policy compliance check for asset: Long Ad Campaign X
2025-07-15 12:40:36,684 - IngestAgent - DEBUG - Thought Chain: Initiating policy compliance check.
2025-07-15 12:40:36,684 - IngestAgent - DEBUG - Thought Chain: Required field 'title' is present. Justification: Metadata completeness criteria met for this field.
2025-07-15 12:40:36,684 - IngestAgent - DEBUG - Thought Chain: Required field 'genre' is present. Justification: Metadata completeness criteria met for this field.
2025-07-15 12:40:36,685 - IngestAgent - DEBUG - Thought Chain: Required field 'language' is present. Justification: Metadata completeness criteria met for this field.
2025-07-15 12:40:36,685 - IngestAgent - DEBUG - Thought Chain: Checking duration policy. Duration: 60.60s, Asset Type: ad
2025-07-15 12:40:36,685 - IngestAgent - DEBUG - Thought Chain: Ad duration policy violated. Justification: Duration exceeds ad-specific limit. Escalation triggered.
2025-07-15 12:40:36,685 - IngestAgent - DEBUG - Thought Chain: Checking file size policy. Size: 101.00 MB, Max: 40960 MB.
2025-07-15 12:40:36,685 - IngestAgent - DEBUG - Thought Chain: File size is within allowed limits. Justification: Complies with file size policy.
2025-07-15 12:40:36,685 - IngestAgent - DEBUG - Thought Chain: Checking E/I rating for kids content.
2025-07-15 12:40:36,685 - IngestAgent - WARNING - Policy compliance issues for Long Ad Campaign X. Flags: ['Ad duration (60.60s) exceeds limit (60s).']
2025-07-15 12:40:36,686 - IngestAgent - DEBUG - Thought Chain: Decision - Policy compliance failed. Status: FAIL. Justification: One or more policy flags were set.
2025-07-15 12:40:36,686 - IngestAgent - ERROR - Escalating asset Long Ad Campaign X to human for review.
2025-07-15 12:40:36,686 - IngestAgent - DEBUG - Thought Chain: Decision - Escalating to human due to critical policy breach. Justification: Escalation flag set by policy check.
2025-07-15 12:40:36,686 - IngestAgent - DEBUG - Thought Chain: Policy compliance check concluded.
2025-07-15 12:40:36,687 - IngestAgent - DEBUG - Thought Chain: Executing Event-Driven Hand-off step.
2025-07-15 12:40:36,687 - IngestAgent - INFO - Handing off asset to downstream agents: N/A
2025-07-15 12:40:36,687 - IngestAgent - DEBUG - Thought Chain: Initiating hand-off process.
2025-07-15 12:40:36,688 - IngestAgent - INFO - Context Shared (simulated hand-off):
{
  "original_path": "./ingest_source/long_ad_campaign_x.mp4",
  "ingest_start_time": "2025-07-15T12:40:29.335263",
  "status": "FAILED_COMPLIANCE",
  "format_valid": true,
  "format_issues": [],
  "transcode_needed": false,
  "initial_transcode_required": false,
  "ffprobe_data": {
    "format": {
      "filename": "long_ad_campaign_x.mp4",
      "nb_streams": 2,
      "format_name": "mp4",
      "duration": 60.6,
      "size": 105906176
    },
    "streams": [
      {
        "codec_type": "video",
        "codec_name": "h264",
        "width": 1920,
        "height": 1080,
        "avg_frame_rate": "25/1",
        "display_aspect_ratio": "16:9"
      },
      {
        "codec_type": "audio",
        "codec_name": "aac",
        "channels": 2
      }
    ]
  },
  "metadata": {
    "source_file": "long_ad_campaign_x.mp4",
    "ingest_timestamp": "2025-07-15T12:40:29.343815",
    "checksum_sha256": "3c195a0507198c7574551ae014247153b20bac784cf0a5c3b1fa5038c2900093",
    "file_size_bytes": 105906176,
    "duration": 60.6,
    "title": "Long Ad Campaign X",
    "genre": "Commercial",
    "language": "English",
    "asset_type": "ad",
    "ai_summary": "\"Long Ad Campaign X\" features various scenes of people using a product in everyday settings. The commercial includes bright visuals and upbeat music.\n",
    "ai_keywords": [
      "product",
      "everyday settings",
      "bright visuals",
      "upbeat music",
      "commercial"
    ],
    "mood": "upbeat",
    "normalized_file_path": "./ingest_processed/asset_b1e2f6ec_long_ad_campaign_x.mp4",
    "normalized_file_name": "asset_b1e2f6ec_long_ad_campaign_x.mp4",
    "compliance_status": "FAIL",
    "compliance_flags": [
      "Ad duration (60.60s) exceeds limit (60s)."
    ],
    "escalate_to_human": true
  },
  "normalized_file_path": "./ingest_processed/asset_b1e2f6ec_long_ad_campaign_x.mp4",
  "escalate_to_human": true,
  "ingest_end_time": "2025-07-15T12:40:36.687193"
}
2025-07-15 12:40:36,691 - IngestAgent - DEBUG - Thought Chain: Hand-off completed successfully. Justification: Asset is compliant or issues were handled internally.
2025-07-15 12:40:36,691 - IngestAgent - INFO - Hand-off complete.
2025-07-15 12:40:36,692 - IngestAgent - INFO - --- Ingestion pipeline completed for: ./ingest_source/long_ad_campaign_x.mp4 ---
2025-07-15 12:40:36,692 - IngestAgent - DEBUG - Thought Chain: Pipeline completed successfully for ./ingest_source/long_ad_campaign_x.mp4.
2025-07-15 12:40:37,407 - IngestAgent - INFO - --- Starting ingestion pipeline for: ./ingest_source/ad_missing_meta.mp4 ---
2025-07-15 12:40:37,407 - IngestAgent - DEBUG - Thought Chain: Pipeline started for ./ingest_source/ad_missing_meta.mp4.
2025-07-15 12:40:37,408 - IngestAgent - INFO - No initial sidecar JSON found for ./ingest_source/ad_missing_meta.mp4.
2025-07-15 12:40:37,408 - IngestAgent - DEBUG - Thought Chain: Executing Format Detection & Validation step.
2025-07-15 12:40:37,409 - IngestAgent - INFO - Starting format detection for: ./ingest_source/ad_missing_meta.mp4
2025-07-15 12:40:37,409 - IngestAgent - DEBUG - Thought Chain: Initiating FFprobe simulation for ./ingest_source/ad_missing_meta.mp4
2025-07-15 12:40:37,409 - IngestAgent - DEBUG - Simulated FFprobe for ./ingest_source/ad_missing_meta.mp4: {'format': {'filename': 'ad_missing_meta.mp4', 'nb_streams': 2, 'format_name': 'mp4', 'duration': 3.0, 'size': 5242880}, 'streams': [{'codec_type': 'video', 'codec_name': 'h264', 'width': 1920, 'height': 1080, 'avg_frame_rate': '25/1', 'display_aspect_ratio': '16:9'}, {'codec_type': 'audio', 'codec_name': 'aac', 'channels': 2}]}
2025-07-15 12:40:37,412 - IngestAgent - DEBUG - Thought Chain: File extension 'mp4' is allowed. Justification: Complies with 'allowed_formats' policy.
2025-07-15 12:40:37,441 - IngestAgent - DEBUG - Thought Chain: No operator override for transcode detected. Justification: Proceeding with standard transcode decision.
2025-07-15 12:40:37,441 - IngestAgent - INFO - Format validation successful for ./ingest_source/ad_missing_meta.mp4.
2025-07-15 12:40:37,441 - IngestAgent - DEBUG - Thought Chain: Decision - Format is compliant. No transcode needed. Justification: All format policies passed.
2025-07-15 12:40:37,442 - IngestAgent - INFO - Format validation successful for ./ingest_source/ad_missing_meta.mp4.
2025-07-15 12:40:37,443 - IngestAgent - DEBUG - Thought Chain: Executing Metadata Extraction & Enrichment step.
2025-07-15 12:40:37,443 - IngestAgent - INFO - Starting metadata extraction for: ./ingest_source/ad_missing_meta.mp4
2025-07-15 12:40:37,443 - IngestAgent - DEBUG - Thought Chain: Initiating metadata extraction and enrichment for ./ingest_source/ad_missing_meta.mp4
2025-07-15 12:40:37,545 - IngestAgent - DEBUG - Calculated sha256 checksum for ./ingest_source/ad_missing_meta.mp4
2025-07-15 12:40:37,546 - IngestAgent - DEBUG - Thought Chain: Basic metadata extracted from file system and FFprobe data.
2025-07-15 12:40:37,546 - IngestAgent - INFO - No sidecar JSON found for ./ingest_source/ad_missing_meta.mp4.
2025-07-15 12:40:37,546 - IngestAgent - DEBUG - Thought Chain: No sidecar JSON found. Justification: No external metadata provided. Proceeding without it.
2025-07-15 12:40:37,546 - IngestAgent - DEBUG - Thought Chain: Title not found. Justification: Inferred from filename as per policy.
2025-07-15 12:40:37,546 - IngestAgent - DEBUG - Thought Chain: Determining asset type for ad_missing_meta.mp4
2025-07-15 12:40:37,546 - IngestAgent - DEBUG - Thought Chain: Identified as 'ad' based on filename heuristic.
2025-07-15 12:40:37,547 - IngestAgent - DEBUG - Thought Chain: Determined asset type: ad.
2025-07-15 12:40:37,549 - IngestAgent - INFO - Determined asset type: ad
2025-07-15 12:40:37,549 - IngestAgent - INFO - Performing real AI enrichment for asset type: ad
2025-07-15 12:40:37,550 - IngestAgent - DEBUG - Thought Chain: Starting AI enrichment. Initial metadata: Ad Missing Meta, type: ad
2025-07-15 12:40:37,550 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI summary based on prompt: 'Generate a very short, concise summary (max 2 sentences) for a media a...'
2025-07-15 12:40:37,550 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:38,587 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:38,588 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI summary. Justification: LLM provided concise overview based on title/genre.
2025-07-15 12:40:38,588 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI keywords based on prompt: 'Extract up to 5 keywords from the following media asset description: '...'
2025-07-15 12:40:38,588 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:39,528 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:39,529 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI keywords. Justification: LLM provided relevant keywords in expected format.
2025-07-15 12:40:39,531 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI mood based on prompt: 'Based on the genre 'N/A' and summary 'The media asset, titled "Ad Miss...'
2025-07-15 12:40:39,531 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:40,391 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:40,392 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI mood. Justification: LLM provided a single-word mood based on context.
2025-07-15 12:40:40,393 - IngestAgent - DEBUG - Real AI enrichment complete. New metadata: {'source_file': 'ad_missing_meta.mp4', 'ingest_timestamp': '2025-07-15T12:40:37.444484', 'checksum_sha256': 'dbbe5517996826bd5861ac22b745d21d11219055d89243ca1aea0ad31f552b12', 'file_size_bytes': 5242880, 'duration': 3.0, 'title': 'Ad Missing Meta', 'asset_type': 'ad', 'ai_summary': 'The media asset, titled "Ad Missing Meta," appears to be an advertisement. No further details are available.\n', 'ai_keywords': ['Ad', 'Missing Meta', 'advertisement'], 'mood': 'unknown'}
2025-07-15 12:40:40,393 - IngestAgent - DEBUG - Thought Chain: AI enrichment process concluded.
2025-07-15 12:40:40,393 - IngestAgent - INFO - Metadata extraction and enrichment complete for ./ingest_source/ad_missing_meta.mp4.
2025-07-15 12:40:40,393 - IngestAgent - DEBUG - Thought Chain: Metadata extraction and enrichment process concluded.
2025-07-15 12:40:40,394 - IngestAgent - DEBUG - Final metadata: {
  "source_file": "ad_missing_meta.mp4",
  "ingest_timestamp": "2025-07-15T12:40:37.444484",
  "checksum_sha256": "dbbe5517996826bd5861ac22b745d21d11219055d89243ca1aea0ad31f552b12",
  "file_size_bytes": 5242880,
  "duration": 3.0,
  "title": "Ad Missing Meta",
  "asset_type": "ad",
  "ai_summary": "The media asset, titled \"Ad Missing Meta,\" appears to be an advertisement. No further details are available.\n",
  "ai_keywords": [
    "Ad",
    "Missing Meta",
    "advertisement"
  ],
  "mood": "unknown"
}
2025-07-15 12:40:40,394 - IngestAgent - DEBUG - Thought Chain: Executing Content Normalization step.
2025-07-15 12:40:40,394 - IngestAgent - INFO - Starting content normalization for: ad_missing_meta.mp4
2025-07-15 12:40:40,394 - IngestAgent - DEBUG - Thought Chain: Initiating content normalization for ad_missing_meta.mp4
2025-07-15 12:40:40,394 - IngestAgent - DEBUG - Thought Chain: Determined normalized name: asset_528237c3_ad_missing_meta.mp4. Justification: Standard naming convention applied.
2025-07-15 12:40:40,395 - IngestAgent - INFO - Normalized and moved ad_missing_meta.mp4 to ./ingest_processed/asset_528237c3_ad_missing_meta.mp4
2025-07-15 12:40:40,395 - IngestAgent - DEBUG - Thought Chain: File successfully moved to normalized path. Justification: Unique content, moved to standard location. Adding checksum to processed set.
2025-07-15 12:40:40,395 - IngestAgent - INFO - Content normalization complete for ./ingest_source/ad_missing_meta.mp4.
2025-07-15 12:40:40,395 - IngestAgent - DEBUG - Thought Chain: Content normalization process concluded.
2025-07-15 12:40:40,396 - IngestAgent - DEBUG - Thought Chain: Executing Policy Compliance Check step.
2025-07-15 12:40:40,396 - IngestAgent - INFO - Starting policy compliance check for asset: Ad Missing Meta
2025-07-15 12:40:40,396 - IngestAgent - DEBUG - Thought Chain: Initiating policy compliance check.
2025-07-15 12:40:40,396 - IngestAgent - DEBUG - Thought Chain: Required field 'title' is present. Justification: Metadata completeness criteria met for this field.
2025-07-15 12:40:40,396 - IngestAgent - DEBUG - Thought Chain: Missing required field 'genre'. Justification: Policy 'required_metadata_fields' violated. Escalation triggered.
2025-07-15 12:40:40,396 - IngestAgent - DEBUG - Thought Chain: Missing required field 'language'. Justification: Policy 'required_metadata_fields' violated. Escalation triggered.
2025-07-15 12:40:40,396 - IngestAgent - DEBUG - Thought Chain: Checking duration policy. Duration: 3.00s, Asset Type: ad
2025-07-15 12:40:40,397 - IngestAgent - DEBUG - Thought Chain: Checking file size policy. Size: 5.00 MB, Max: 40960 MB.
2025-07-15 12:40:40,397 - IngestAgent - DEBUG - Thought Chain: File size is within allowed limits. Justification: Complies with file size policy.
2025-07-15 12:40:40,397 - IngestAgent - DEBUG - Thought Chain: Checking E/I rating for kids content.
2025-07-15 12:40:40,397 - IngestAgent - WARNING - Policy compliance issues for Ad Missing Meta. Flags: ['Missing required metadata field: genre.', 'Missing required metadata field: language.']
2025-07-15 12:40:40,397 - IngestAgent - DEBUG - Thought Chain: Decision - Policy compliance failed. Status: FAIL. Justification: One or more policy flags were set.
2025-07-15 12:40:40,397 - IngestAgent - ERROR - Escalating asset Ad Missing Meta to human for review.
2025-07-15 12:40:40,398 - IngestAgent - DEBUG - Thought Chain: Decision - Escalating to human due to critical policy breach. Justification: Escalation flag set by policy check.
2025-07-15 12:40:40,398 - IngestAgent - DEBUG - Thought Chain: Policy compliance check concluded.
2025-07-15 12:40:40,399 - IngestAgent - DEBUG - Thought Chain: Executing Event-Driven Hand-off step.
2025-07-15 12:40:40,399 - IngestAgent - INFO - Handing off asset to downstream agents: N/A
2025-07-15 12:40:40,400 - IngestAgent - DEBUG - Thought Chain: Initiating hand-off process.
2025-07-15 12:40:40,400 - IngestAgent - INFO - Context Shared (simulated hand-off):
{
  "original_path": "./ingest_source/ad_missing_meta.mp4",
  "ingest_start_time": "2025-07-15T12:40:37.407266",
  "status": "FAILED_COMPLIANCE",
  "format_valid": true,
  "format_issues": [],
  "transcode_needed": false,
  "initial_transcode_required": false,
  "ffprobe_data": {
    "format": {
      "filename": "ad_missing_meta.mp4",
      "nb_streams": 2,
      "format_name": "mp4",
      "duration": 3.0,
      "size": 5242880
    },
    "streams": [
      {
        "codec_type": "video",
        "codec_name": "h264",
        "width": 1920,
        "height": 1080,
        "avg_frame_rate": "25/1",
        "display_aspect_ratio": "16:9"
      },
      {
        "codec_type": "audio",
        "codec_name": "aac",
        "channels": 2
      }
    ]
  },
  "metadata": {
    "source_file": "ad_missing_meta.mp4",
    "ingest_timestamp": "2025-07-15T12:40:37.444484",
    "checksum_sha256": "dbbe5517996826bd5861ac22b745d21d11219055d89243ca1aea0ad31f552b12",
    "file_size_bytes": 5242880,
    "duration": 3.0,
    "title": "Ad Missing Meta",
    "asset_type": "ad",
    "ai_summary": "The media asset, titled \"Ad Missing Meta,\" appears to be an advertisement. No further details are available.\n",
    "ai_keywords": [
      "Ad",
      "Missing Meta",
      "advertisement"
    ],
    "mood": "unknown",
    "normalized_file_path": "./ingest_processed/asset_528237c3_ad_missing_meta.mp4",
    "normalized_file_name": "asset_528237c3_ad_missing_meta.mp4",
    "compliance_status": "FAIL",
    "compliance_flags": [
      "Missing required metadata field: genre.",
      "Missing required metadata field: language."
    ],
    "escalate_to_human": true
  },
  "normalized_file_path": "./ingest_processed/asset_528237c3_ad_missing_meta.mp4",
  "escalate_to_human": true,
  "ingest_end_time": "2025-07-15T12:40:40.399204"
}
2025-07-15 12:40:40,400 - IngestAgent - DEBUG - Thought Chain: Hand-off completed successfully. Justification: Asset is compliant or issues were handled internally.
2025-07-15 12:40:40,403 - IngestAgent - INFO - Hand-off complete.
2025-07-15 12:40:40,403 - IngestAgent - INFO - --- Ingestion pipeline completed for: ./ingest_source/ad_missing_meta.mp4 ---
2025-07-15 12:40:40,403 - IngestAgent - DEBUG - Thought Chain: Pipeline completed successfully for ./ingest_source/ad_missing_meta.mp4.
2025-07-15 12:40:41,111 - IngestAgent - INFO - --- Starting ingestion pipeline for: ./ingest_source/corrupted_header.mp4 ---
2025-07-15 12:40:41,111 - IngestAgent - DEBUG - Thought Chain: Pipeline started for ./ingest_source/corrupted_header.mp4.
2025-07-15 12:40:41,111 - IngestAgent - INFO - No initial sidecar JSON found for ./ingest_source/corrupted_header.mp4.
2025-07-15 12:40:41,112 - IngestAgent - DEBUG - Thought Chain: Executing Format Detection & Validation step.
2025-07-15 12:40:41,112 - IngestAgent - INFO - Starting format detection for: ./ingest_source/corrupted_header.mp4
2025-07-15 12:40:41,112 - IngestAgent - DEBUG - Thought Chain: Initiating FFprobe simulation for ./ingest_source/corrupted_header.mp4
2025-07-15 12:40:41,113 - IngestAgent - WARNING - Simulating FFprobe failure for ./ingest_source/corrupted_header.mp4 due to suspected corruption by name.
2025-07-15 12:40:41,113 - IngestAgent - DEBUG - Thought Chain: FFprobe simulation failed. Justification: Simulated corrupted header or unreadable file. Format invalid.
2025-07-15 12:40:41,114 - IngestAgent - ERROR - Ingestion failed for ./ingest_source/corrupted_header.mp4: Format invalid and transcode not applicable/possible.
2025-07-15 12:40:41,115 - IngestAgent - INFO - Handing off asset to downstream agents: N/A
2025-07-15 12:40:41,115 - IngestAgent - DEBUG - Thought Chain: Initiating hand-off process.
2025-07-15 12:40:41,115 - IngestAgent - INFO - Context Shared (simulated hand-off):
{
  "original_path": "./ingest_source/corrupted_header.mp4",
  "ingest_start_time": "2025-07-15T12:40:41.111191",
  "status": "FAILED_FORMAT_VALIDATION",
  "format_valid": false,
  "format_issues": [
    "Could not get format information (FFprobe simulation failed)."
  ],
  "transcode_needed": false,
  "initial_transcode_required": false,
  "ffprobe_data": {}
}
2025-07-15 12:40:41,115 - IngestAgent - DEBUG - Thought Chain: Hand-off completed successfully. Justification: Asset is compliant or issues were handled internally.
2025-07-15 12:40:41,115 - IngestAgent - INFO - Hand-off complete.
2025-07-15 12:40:41,621 - IngestAgent - INFO - --- Starting ingestion pipeline for: ./ingest_source/oversized_file_test.mp4 ---
2025-07-15 12:40:41,621 - IngestAgent - DEBUG - Thought Chain: Pipeline started for ./ingest_source/oversized_file_test.mp4.
2025-07-15 12:40:41,621 - IngestAgent - INFO - No initial sidecar JSON found for ./ingest_source/oversized_file_test.mp4.
2025-07-15 12:40:41,621 - IngestAgent - DEBUG - Thought Chain: Executing Format Detection & Validation step.
2025-07-15 12:40:41,622 - IngestAgent - INFO - Starting format detection for: ./ingest_source/oversized_file_test.mp4
2025-07-15 12:40:41,622 - IngestAgent - DEBUG - Thought Chain: Initiating FFprobe simulation for ./ingest_source/oversized_file_test.mp4
2025-07-15 12:40:41,622 - IngestAgent - WARNING - Simulating FFprobe reporting 50GB size for oversized file: ./ingest_source/oversized_file_test.mp4
2025-07-15 12:40:41,623 - IngestAgent - DEBUG - Simulated FFprobe for ./ingest_source/oversized_file_test.mp4: {'format': {'filename': 'oversized_file_test.mp4', 'nb_streams': 2, 'format_name': 'mp4', 'duration': 30720.0, 'size': 53687091200}, 'streams': [{'codec_type': 'video', 'codec_name': 'h264', 'width': 1920, 'height': 1080, 'avg_frame_rate': '25/1', 'display_aspect_ratio': '16:9'}, {'codec_type': 'audio', 'codec_name': 'aac', 'channels': 2}]}
2025-07-15 12:40:41,624 - IngestAgent - DEBUG - Thought Chain: File extension 'mp4' is allowed. Justification: Complies with 'allowed_formats' policy.
2025-07-15 12:40:41,624 - IngestAgent - DEBUG - Thought Chain: No operator override for transcode detected. Justification: Proceeding with standard transcode decision.
2025-07-15 12:40:41,624 - IngestAgent - INFO - Format validation successful for ./ingest_source/oversized_file_test.mp4.
2025-07-15 12:40:41,624 - IngestAgent - DEBUG - Thought Chain: Decision - Format is compliant. No transcode needed. Justification: All format policies passed.
2025-07-15 12:40:41,626 - IngestAgent - INFO - Format validation successful for ./ingest_source/oversized_file_test.mp4.
2025-07-15 12:40:41,626 - IngestAgent - DEBUG - Thought Chain: Executing Metadata Extraction & Enrichment step.
2025-07-15 12:40:41,627 - IngestAgent - INFO - Starting metadata extraction for: ./ingest_source/oversized_file_test.mp4
2025-07-15 12:40:41,627 - IngestAgent - DEBUG - Thought Chain: Initiating metadata extraction and enrichment for ./ingest_source/oversized_file_test.mp4
2025-07-15 12:40:41,707 - IngestAgent - DEBUG - Calculated sha256 checksum for ./ingest_source/oversized_file_test.mp4
2025-07-15 12:40:41,710 - IngestAgent - DEBUG - Thought Chain: Basic metadata extracted from file system and FFprobe data.
2025-07-15 12:40:41,711 - IngestAgent - INFO - No sidecar JSON found for ./ingest_source/oversized_file_test.mp4.
2025-07-15 12:40:41,711 - IngestAgent - DEBUG - Thought Chain: No sidecar JSON found. Justification: No external metadata provided. Proceeding without it.
2025-07-15 12:40:41,711 - IngestAgent - DEBUG - Thought Chain: Title not found. Justification: Inferred from filename as per policy.
2025-07-15 12:40:41,711 - IngestAgent - DEBUG - Thought Chain: Determining asset type for oversized_file_test.mp4
2025-07-15 12:40:41,711 - IngestAgent - DEBUG - Thought Chain: Determined asset type: episode.
2025-07-15 12:40:41,712 - IngestAgent - INFO - Determined asset type: episode
2025-07-15 12:40:41,712 - IngestAgent - INFO - Performing real AI enrichment for asset type: episode
2025-07-15 12:40:41,712 - IngestAgent - DEBUG - Thought Chain: Starting AI enrichment. Initial metadata: Oversized File Test, type: episode
2025-07-15 12:40:41,713 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI summary based on prompt: 'Generate a very short, concise summary (max 2 sentences) for a media a...'
2025-07-15 12:40:41,713 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:43,799 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:43,800 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI summary. Justification: LLM provided concise overview based on title/genre.
2025-07-15 12:40:43,801 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI keywords based on prompt: 'Extract up to 5 keywords from the following media asset description: '...'
2025-07-15 12:40:43,802 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:45,028 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:45,030 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI keywords. Justification: LLM provided relevant keywords in expected format.
2025-07-15 12:40:45,032 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI mood based on prompt: 'Based on the genre 'N/A' and summary 'This media asset, titled "Oversi...'
2025-07-15 12:40:45,032 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:45,927 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:45,929 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI mood. Justification: LLM provided a single-word mood based on context.
2025-07-15 12:40:45,930 - IngestAgent - DEBUG - Real AI enrichment complete. New metadata: {'source_file': 'oversized_file_test.mp4', 'ingest_timestamp': '2025-07-15T12:40:41.627846', 'checksum_sha256': '4e29ad18ab9f42d7c233500771a39d7c852b200baf328fd00fbbe3fecea1eb56', 'file_size_bytes': 53687091200, 'duration': 30720.0, 'title': 'Oversized File Test', 'asset_type': 'episode', 'ai_summary': 'This media asset, titled "Oversized File Test," is of unspecified genre. Its content is unknown.\n', 'ai_keywords': ['Oversized File Test', 'media asset', 'unspecified genre', 'unknown content'], 'mood': 'neutral'}
2025-07-15 12:40:45,930 - IngestAgent - DEBUG - Thought Chain: AI enrichment process concluded.
2025-07-15 12:40:45,931 - IngestAgent - INFO - Metadata extraction and enrichment complete for ./ingest_source/oversized_file_test.mp4.
2025-07-15 12:40:45,931 - IngestAgent - DEBUG - Thought Chain: Metadata extraction and enrichment process concluded.
2025-07-15 12:40:45,932 - IngestAgent - DEBUG - Final metadata: {
  "source_file": "oversized_file_test.mp4",
  "ingest_timestamp": "2025-07-15T12:40:41.627846",
  "checksum_sha256": "4e29ad18ab9f42d7c233500771a39d7c852b200baf328fd00fbbe3fecea1eb56",
  "file_size_bytes": 53687091200,
  "duration": 30720.0,
  "title": "Oversized File Test",
  "asset_type": "episode",
  "ai_summary": "This media asset, titled \"Oversized File Test,\" is of unspecified genre. Its content is unknown.\n",
  "ai_keywords": [
    "Oversized File Test",
    "media asset",
    "unspecified genre",
    "unknown content"
  ],
  "mood": "neutral"
}
2025-07-15 12:40:45,932 - IngestAgent - DEBUG - Thought Chain: Executing Content Normalization step.
2025-07-15 12:40:45,933 - IngestAgent - INFO - Starting content normalization for: oversized_file_test.mp4
2025-07-15 12:40:45,933 - IngestAgent - DEBUG - Thought Chain: Initiating content normalization for oversized_file_test.mp4
2025-07-15 12:40:45,933 - IngestAgent - DEBUG - Thought Chain: Determined normalized name: asset_50c7b401_oversized_file_test.mp4. Justification: Standard naming convention applied.
2025-07-15 12:40:45,933 - IngestAgent - INFO - Skipping move for duplicate file oversized_file_test.mp4. Already processed content.
2025-07-15 12:40:45,933 - IngestAgent - DEBUG - Thought Chain: Not moving duplicate file. Justification: Content hash matches existing processed asset. Content already exists in normalized form.
2025-07-15 12:40:45,933 - IngestAgent - INFO - Content normalization complete for ./ingest_source/oversized_file_test.mp4.
2025-07-15 12:40:45,933 - IngestAgent - DEBUG - Thought Chain: Content normalization process concluded.
2025-07-15 12:40:45,934 - IngestAgent - INFO - Ingestion pipeline skipped for ./ingest_source/oversized_file_test.mp4: Duplicate content detected.
2025-07-15 12:40:45,934 - IngestAgent - DEBUG - Thought Chain: Decision - Pipeline terminated due to duplicate content. Justification: Asset content already exists in the system.
2025-07-15 12:40:45,934 - IngestAgent - INFO - Handing off asset to downstream agents: N/A
2025-07-15 12:40:45,934 - IngestAgent - DEBUG - Thought Chain: Initiating hand-off process.
2025-07-15 12:40:45,935 - IngestAgent - INFO - Context Shared (simulated hand-off):
{
  "original_path": "./ingest_source/oversized_file_test.mp4",
  "ingest_start_time": "2025-07-15T12:40:41.620805",
  "status": "DUPLICATE_SKIPPED",
  "format_valid": true,
  "format_issues": [],
  "transcode_needed": false,
  "initial_transcode_required": false,
  "ffprobe_data": {
    "format": {
      "filename": "oversized_file_test.mp4",
      "nb_streams": 2,
      "format_name": "mp4",
      "duration": 30720.0,
      "size": 53687091200
    },
    "streams": [
      {
        "codec_type": "video",
        "codec_name": "h264",
        "width": 1920,
        "height": 1080,
        "avg_frame_rate": "25/1",
        "display_aspect_ratio": "16:9"
      },
      {
        "codec_type": "audio",
        "codec_name": "aac",
        "channels": 2
      }
    ]
  },
  "metadata": {
    "source_file": "oversized_file_test.mp4",
    "ingest_timestamp": "2025-07-15T12:40:41.627846",
    "checksum_sha256": "4e29ad18ab9f42d7c233500771a39d7c852b200baf328fd00fbbe3fecea1eb56",
    "file_size_bytes": 53687091200,
    "duration": 30720.0,
    "title": "Oversized File Test",
    "asset_type": "episode",
    "ai_summary": "This media asset, titled \"Oversized File Test,\" is of unspecified genre. Its content is unknown.\n",
    "ai_keywords": [
      "Oversized File Test",
      "media asset",
      "unspecified genre",
      "unknown content"
    ],
    "mood": "neutral",
    "normalized_file_path": "DUPLICATE_SKIPPED_MOVE",
    "normalized_file_name": "DUPLICATE_SKIPPED_MOVE"
  }
}
2025-07-15 12:40:45,935 - IngestAgent - DEBUG - Thought Chain: Hand-off completed successfully. Justification: Asset is compliant or issues were handled internally.
2025-07-15 12:40:45,935 - IngestAgent - INFO - Hand-off complete.
2025-07-15 12:40:46,448 - IngestAgent - INFO - --- Starting ingestion pipeline for: ./ingest_source/duplicate_content_video.mp4 ---
2025-07-15 12:40:46,449 - IngestAgent - DEBUG - Thought Chain: Pipeline started for ./ingest_source/duplicate_content_video.mp4.
2025-07-15 12:40:46,450 - IngestAgent - DEBUG - Thought Chain: Loaded initial metadata from sidecar for override checks.
2025-07-15 12:40:46,451 - IngestAgent - DEBUG - Thought Chain: Executing Format Detection & Validation step.
2025-07-15 12:40:46,452 - IngestAgent - INFO - Starting format detection for: ./ingest_source/duplicate_content_video.mp4
2025-07-15 12:40:46,452 - IngestAgent - DEBUG - Thought Chain: Initiating FFprobe simulation for ./ingest_source/duplicate_content_video.mp4
2025-07-15 12:40:46,452 - IngestAgent - DEBUG - Simulated FFprobe for ./ingest_source/duplicate_content_video.mp4: {'format': {'filename': 'duplicate_content_video.mp4', 'nb_streams': 2, 'format_name': 'mp4', 'duration': 6.0, 'size': 10485760}, 'streams': [{'codec_type': 'video', 'codec_name': 'h264', 'width': 1920, 'height': 1080, 'avg_frame_rate': '25/1', 'display_aspect_ratio': '16:9'}, {'codec_type': 'audio', 'codec_name': 'aac', 'channels': 2}]}
2025-07-15 12:40:46,454 - IngestAgent - DEBUG - Thought Chain: File extension 'mp4' is allowed. Justification: Complies with 'allowed_formats' policy.
2025-07-15 12:40:46,454 - IngestAgent - DEBUG - Thought Chain: No operator override for transcode detected. Justification: Proceeding with standard transcode decision.
2025-07-15 12:40:46,454 - IngestAgent - INFO - Format validation successful for ./ingest_source/duplicate_content_video.mp4.
2025-07-15 12:40:46,454 - IngestAgent - DEBUG - Thought Chain: Decision - Format is compliant. No transcode needed. Justification: All format policies passed.
2025-07-15 12:40:46,455 - IngestAgent - INFO - Format validation successful for ./ingest_source/duplicate_content_video.mp4.
2025-07-15 12:40:46,455 - IngestAgent - DEBUG - Thought Chain: Executing Metadata Extraction & Enrichment step.
2025-07-15 12:40:46,456 - IngestAgent - INFO - Starting metadata extraction for: ./ingest_source/duplicate_content_video.mp4
2025-07-15 12:40:46,456 - IngestAgent - DEBUG - Thought Chain: Initiating metadata extraction and enrichment for ./ingest_source/duplicate_content_video.mp4
2025-07-15 12:40:46,574 - IngestAgent - DEBUG - Calculated sha256 checksum for ./ingest_source/duplicate_content_video.mp4
2025-07-15 12:40:46,575 - IngestAgent - DEBUG - Thought Chain: Basic metadata extracted from file system and FFprobe data.
2025-07-15 12:40:46,577 - IngestAgent - INFO - Extracted metadata from sidecar: ./ingest_source/duplicate_content_video.json
2025-07-15 12:40:46,577 - IngestAgent - DEBUG - Thought Chain: Sidecar JSON found and merged. Justification: External metadata source provided.
2025-07-15 12:40:46,578 - IngestAgent - DEBUG - Thought Chain: Title already present in metadata. Justification: Existing metadata takes precedence.
2025-07-15 12:40:46,578 - IngestAgent - DEBUG - Thought Chain: Determining asset type for duplicate_content_video.mp4
2025-07-15 12:40:46,578 - IngestAgent - DEBUG - Thought Chain: Determined asset type: episode.
2025-07-15 12:40:46,579 - IngestAgent - INFO - Determined asset type: episode
2025-07-15 12:40:46,579 - IngestAgent - INFO - Performing real AI enrichment for asset type: episode
2025-07-15 12:40:46,580 - IngestAgent - DEBUG - Thought Chain: Starting AI enrichment. Initial metadata: Duplicate Content, type: episode
2025-07-15 12:40:46,580 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI summary based on prompt: 'Generate a very short, concise summary (max 2 sentences) for a media a...'
2025-07-15 12:40:46,591 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:47,702 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:47,704 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI summary. Justification: LLM provided concise overview based on title/genre.
2025-07-15 12:40:47,704 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI keywords based on prompt: 'Extract up to 5 keywords from the following media asset description: '...'
2025-07-15 12:40:47,705 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:48,716 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:48,718 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI keywords. Justification: LLM provided relevant keywords in expected format.
2025-07-15 12:40:48,718 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI mood based on prompt: 'Based on the genre 'Test' and summary 'This Test media asset appears t...'
2025-07-15 12:40:48,719 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:49,946 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:49,948 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI mood. Justification: LLM provided a single-word mood based on context.
2025-07-15 12:40:49,949 - IngestAgent - DEBUG - Real AI enrichment complete. New metadata: {'source_file': 'duplicate_content_video.mp4', 'ingest_timestamp': '2025-07-15T12:40:46.456504', 'checksum_sha256': 'eb6183addde05c2196ce25e6fa34a4baf20f9bf30d33892f452a9a1e88c9a472', 'file_size_bytes': 10485760, 'duration': 6.0, 'title': 'Duplicate Content', 'genre': 'Test', 'language': 'English', 'asset_type': 'episode', 'ai_summary': "This Test media asset appears to feature repeated information. The content is labeled 'Duplicate Content'.\n", 'ai_keywords': ['Duplicate Content', 'repeated information', 'Test media asset'], 'mood': 'boring'}
2025-07-15 12:40:49,949 - IngestAgent - DEBUG - Thought Chain: AI enrichment process concluded.
2025-07-15 12:40:49,950 - IngestAgent - INFO - Metadata extraction and enrichment complete for ./ingest_source/duplicate_content_video.mp4.
2025-07-15 12:40:49,950 - IngestAgent - DEBUG - Thought Chain: Metadata extraction and enrichment process concluded.
2025-07-15 12:40:49,951 - IngestAgent - DEBUG - Final metadata: {
  "source_file": "duplicate_content_video.mp4",
  "ingest_timestamp": "2025-07-15T12:40:46.456504",
  "checksum_sha256": "eb6183addde05c2196ce25e6fa34a4baf20f9bf30d33892f452a9a1e88c9a472",
  "file_size_bytes": 10485760,
  "duration": 6.0,
  "title": "Duplicate Content",
  "genre": "Test",
  "language": "English",
  "asset_type": "episode",
  "ai_summary": "This Test media asset appears to feature repeated information. The content is labeled 'Duplicate Content'.\n",
  "ai_keywords": [
    "Duplicate Content",
    "repeated information",
    "Test media asset"
  ],
  "mood": "boring"
}
2025-07-15 12:40:49,951 - IngestAgent - DEBUG - Thought Chain: Executing Content Normalization step.
2025-07-15 12:40:49,952 - IngestAgent - INFO - Starting content normalization for: duplicate_content_video.mp4
2025-07-15 12:40:49,952 - IngestAgent - DEBUG - Thought Chain: Initiating content normalization for duplicate_content_video.mp4
2025-07-15 12:40:49,952 - IngestAgent - DEBUG - Thought Chain: Determined normalized name: asset_899e72b2_duplicate_content.mp4. Justification: Standard naming convention applied.
2025-07-15 12:40:49,953 - IngestAgent - INFO - Normalized and moved duplicate_content_video.mp4 to ./ingest_processed/asset_899e72b2_duplicate_content.mp4
2025-07-15 12:40:49,953 - IngestAgent - DEBUG - Thought Chain: File successfully moved to normalized path. Justification: Unique content, moved to standard location. Adding checksum to processed set.
2025-07-15 12:40:49,953 - IngestAgent - INFO - Content normalization complete for ./ingest_source/duplicate_content_video.mp4.
2025-07-15 12:40:49,953 - IngestAgent - DEBUG - Thought Chain: Content normalization process concluded.
2025-07-15 12:40:49,954 - IngestAgent - DEBUG - Thought Chain: Executing Policy Compliance Check step.
2025-07-15 12:40:49,954 - IngestAgent - INFO - Starting policy compliance check for asset: Duplicate Content
2025-07-15 12:40:49,955 - IngestAgent - DEBUG - Thought Chain: Initiating policy compliance check.
2025-07-15 12:40:49,955 - IngestAgent - DEBUG - Thought Chain: Required field 'title' is present. Justification: Metadata completeness criteria met for this field.
2025-07-15 12:40:49,955 - IngestAgent - DEBUG - Thought Chain: Required field 'genre' is present. Justification: Metadata completeness criteria met for this field.
2025-07-15 12:40:49,955 - IngestAgent - DEBUG - Thought Chain: Required field 'language' is present. Justification: Metadata completeness criteria met for this field.
2025-07-15 12:40:49,955 - IngestAgent - DEBUG - Thought Chain: Checking duration policy. Duration: 6.00s, Asset Type: episode
2025-07-15 12:40:49,955 - IngestAgent - DEBUG - Thought Chain: General content duration below minimum. Justification: Duration too short. Escalation triggered.
2025-07-15 12:40:49,956 - IngestAgent - DEBUG - Thought Chain: Checking file size policy. Size: 10.00 MB, Max: 40960 MB.
2025-07-15 12:40:49,956 - IngestAgent - DEBUG - Thought Chain: File size is within allowed limits. Justification: Complies with file size policy.
2025-07-15 12:40:49,956 - IngestAgent - DEBUG - Thought Chain: Checking E/I rating for kids content.
2025-07-15 12:40:49,956 - IngestAgent - WARNING - Policy compliance issues for Duplicate Content. Flags: ['Duration (6.00s) below minimum (10s).']
2025-07-15 12:40:49,956 - IngestAgent - DEBUG - Thought Chain: Decision - Policy compliance failed. Status: FAIL. Justification: One or more policy flags were set.
2025-07-15 12:40:49,956 - IngestAgent - ERROR - Escalating asset Duplicate Content to human for review.
2025-07-15 12:40:49,957 - IngestAgent - DEBUG - Thought Chain: Decision - Escalating to human due to critical policy breach. Justification: Escalation flag set by policy check.
2025-07-15 12:40:49,957 - IngestAgent - DEBUG - Thought Chain: Policy compliance check concluded.
2025-07-15 12:40:49,958 - IngestAgent - DEBUG - Thought Chain: Executing Event-Driven Hand-off step.
2025-07-15 12:40:49,959 - IngestAgent - INFO - Handing off asset to downstream agents: N/A
2025-07-15 12:40:49,959 - IngestAgent - DEBUG - Thought Chain: Initiating hand-off process.
2025-07-15 12:40:49,959 - IngestAgent - INFO - Context Shared (simulated hand-off):
{
  "original_path": "./ingest_source/duplicate_content_video.mp4",
  "ingest_start_time": "2025-07-15T12:40:46.448578",
  "status": "FAILED_COMPLIANCE",
  "format_valid": true,
  "format_issues": [],
  "transcode_needed": false,
  "initial_transcode_required": false,
  "ffprobe_data": {
    "format": {
      "filename": "duplicate_content_video.mp4",
      "nb_streams": 2,
      "format_name": "mp4",
      "duration": 6.0,
      "size": 10485760
    },
    "streams": [
      {
        "codec_type": "video",
        "codec_name": "h264",
        "width": 1920,
        "height": 1080,
        "avg_frame_rate": "25/1",
        "display_aspect_ratio": "16:9"
      },
      {
        "codec_type": "audio",
        "codec_name": "aac",
        "channels": 2
      }
    ]
  },
  "metadata": {
    "source_file": "duplicate_content_video.mp4",
    "ingest_timestamp": "2025-07-15T12:40:46.456504",
    "checksum_sha256": "eb6183addde05c2196ce25e6fa34a4baf20f9bf30d33892f452a9a1e88c9a472",
    "file_size_bytes": 10485760,
    "duration": 6.0,
    "title": "Duplicate Content",
    "genre": "Test",
    "language": "English",
    "asset_type": "episode",
    "ai_summary": "This Test media asset appears to feature repeated information. The content is labeled 'Duplicate Content'.\n",
    "ai_keywords": [
      "Duplicate Content",
      "repeated information",
      "Test media asset"
    ],
    "mood": "boring",
    "normalized_file_path": "./ingest_processed/asset_899e72b2_duplicate_content.mp4",
    "normalized_file_name": "asset_899e72b2_duplicate_content.mp4",
    "compliance_status": "FAIL",
    "compliance_flags": [
      "Duration (6.00s) below minimum (10s)."
    ],
    "escalate_to_human": true
  },
  "normalized_file_path": "./ingest_processed/asset_899e72b2_duplicate_content.mp4",
  "escalate_to_human": true,
  "ingest_end_time": "2025-07-15T12:40:49.958251"
}
2025-07-15 12:40:49,960 - IngestAgent - DEBUG - Thought Chain: Hand-off completed successfully. Justification: Asset is compliant or issues were handled internally.
2025-07-15 12:40:49,960 - IngestAgent - INFO - Hand-off complete.
2025-07-15 12:40:49,961 - IngestAgent - INFO - --- Ingestion pipeline completed for: ./ingest_source/duplicate_content_video.mp4 ---
2025-07-15 12:40:49,961 - IngestAgent - DEBUG - Thought Chain: Pipeline completed successfully for ./ingest_source/duplicate_content_video.mp4.
2025-07-15 12:40:50,676 - IngestAgent - INFO - --- Starting ingestion pipeline for: ./ingest_source/another_copy_of_duplicate.mp4 ---
2025-07-15 12:40:50,676 - IngestAgent - DEBUG - Thought Chain: Pipeline started for ./ingest_source/another_copy_of_duplicate.mp4.
2025-07-15 12:40:50,676 - IngestAgent - DEBUG - Thought Chain: Loaded initial metadata from sidecar for override checks.
2025-07-15 12:40:50,677 - IngestAgent - DEBUG - Thought Chain: Executing Format Detection & Validation step.
2025-07-15 12:40:50,697 - IngestAgent - INFO - Starting format detection for: ./ingest_source/another_copy_of_duplicate.mp4
2025-07-15 12:40:50,697 - IngestAgent - DEBUG - Thought Chain: Initiating FFprobe simulation for ./ingest_source/another_copy_of_duplicate.mp4
2025-07-15 12:40:50,698 - IngestAgent - DEBUG - Simulated FFprobe for ./ingest_source/another_copy_of_duplicate.mp4: {'format': {'filename': 'another_copy_of_duplicate.mp4', 'nb_streams': 2, 'format_name': 'mp4', 'duration': 6.0, 'size': 10485760}, 'streams': [{'codec_type': 'video', 'codec_name': 'h264', 'width': 1920, 'height': 1080, 'avg_frame_rate': '25/1', 'display_aspect_ratio': '16:9'}, {'codec_type': 'audio', 'codec_name': 'aac', 'channels': 2}]}
2025-07-15 12:40:50,700 - IngestAgent - DEBUG - Thought Chain: File extension 'mp4' is allowed. Justification: Complies with 'allowed_formats' policy.
2025-07-15 12:40:50,701 - IngestAgent - DEBUG - Thought Chain: No operator override for transcode detected. Justification: Proceeding with standard transcode decision.
2025-07-15 12:40:50,701 - IngestAgent - INFO - Format validation successful for ./ingest_source/another_copy_of_duplicate.mp4.
2025-07-15 12:40:50,701 - IngestAgent - DEBUG - Thought Chain: Decision - Format is compliant. No transcode needed. Justification: All format policies passed.
2025-07-15 12:40:50,702 - IngestAgent - INFO - Format validation successful for ./ingest_source/another_copy_of_duplicate.mp4.
2025-07-15 12:40:50,702 - IngestAgent - DEBUG - Thought Chain: Executing Metadata Extraction & Enrichment step.
2025-07-15 12:40:50,702 - IngestAgent - INFO - Starting metadata extraction for: ./ingest_source/another_copy_of_duplicate.mp4
2025-07-15 12:40:50,703 - IngestAgent - DEBUG - Thought Chain: Initiating metadata extraction and enrichment for ./ingest_source/another_copy_of_duplicate.mp4
2025-07-15 12:40:50,815 - IngestAgent - DEBUG - Calculated sha256 checksum for ./ingest_source/another_copy_of_duplicate.mp4
2025-07-15 12:40:50,816 - IngestAgent - DEBUG - Thought Chain: Basic metadata extracted from file system and FFprobe data.
2025-07-15 12:40:50,816 - IngestAgent - INFO - Extracted metadata from sidecar: ./ingest_source/another_copy_of_duplicate.json
2025-07-15 12:40:50,817 - IngestAgent - DEBUG - Thought Chain: Sidecar JSON found and merged. Justification: External metadata source provided.
2025-07-15 12:40:50,818 - IngestAgent - DEBUG - Thought Chain: Title already present in metadata. Justification: Existing metadata takes precedence.
2025-07-15 12:40:50,819 - IngestAgent - DEBUG - Thought Chain: Determining asset type for another_copy_of_duplicate.mp4
2025-07-15 12:40:50,819 - IngestAgent - DEBUG - Thought Chain: Determined asset type: episode.
2025-07-15 12:40:50,819 - IngestAgent - INFO - Determined asset type: episode
2025-07-15 12:40:50,819 - IngestAgent - INFO - Performing real AI enrichment for asset type: episode
2025-07-15 12:40:50,819 - IngestAgent - DEBUG - Thought Chain: Starting AI enrichment. Initial metadata: Duplicate Content, type: episode
2025-07-15 12:40:50,820 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI summary based on prompt: 'Generate a very short, concise summary (max 2 sentences) for a media a...'
2025-07-15 12:40:50,820 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:53,014 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:53,015 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI summary. Justification: LLM provided concise overview based on title/genre.
2025-07-15 12:40:53,017 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI keywords based on prompt: 'Extract up to 5 keywords from the following media asset description: '...'
2025-07-15 12:40:53,017 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:54,037 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:54,038 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI keywords. Justification: LLM provided relevant keywords in expected format.
2025-07-15 12:40:54,039 - IngestAgent - DEBUG - Thought Chain: Attempting to generate AI mood based on prompt: 'Based on the genre 'Test' and summary 'The asset titled 'Duplicate Con...'
2025-07-15 12:40:54,040 - IngestAgent - DEBUG - Using API key from GOOGLE_API_KEY environment variable.
2025-07-15 12:40:54,923 - IngestAgent - DEBUG - LLM call made. Recording will be handled by Langfuse via OTel.
2025-07-15 12:40:54,925 - IngestAgent - DEBUG - Thought Chain: Successfully generated AI mood. Justification: LLM provided a single-word mood based on context.
2025-07-15 12:40:54,926 - IngestAgent - DEBUG - Real AI enrichment complete. New metadata: {'source_file': 'another_copy_of_duplicate.mp4', 'ingest_timestamp': '2025-07-15T12:40:50.703190', 'checksum_sha256': 'eb6183addde05c2196ce25e6fa34a4baf20f9bf30d33892f452a9a1e88c9a472', 'file_size_bytes': 10485760, 'duration': 6.0, 'title': 'Duplicate Content', 'genre': 'Test', 'language': 'English', 'asset_type': 'episode', 'ai_summary': "The asset titled 'Duplicate Content' shows replicated text. It appears to be a test file.\n", 'ai_keywords': ['Duplicate Content', 'replicated text', 'test file'], 'mood': 'neutral'}
2025-07-15 12:40:54,927 - IngestAgent - DEBUG - Thought Chain: AI enrichment process concluded.
2025-07-15 12:40:54,927 - IngestAgent - INFO - Metadata extraction and enrichment complete for ./ingest_source/another_copy_of_duplicate.mp4.
2025-07-15 12:40:54,928 - IngestAgent - DEBUG - Thought Chain: Metadata extraction and enrichment process concluded.
2025-07-15 12:40:54,929 - IngestAgent - DEBUG - Final metadata: {
  "source_file": "another_copy_of_duplicate.mp4",
  "ingest_timestamp": "2025-07-15T12:40:50.703190",
  "checksum_sha256": "eb6183addde05c2196ce25e6fa34a4baf20f9bf30d33892f452a9a1e88c9a472",
  "file_size_bytes": 10485760,
  "duration": 6.0,
  "title": "Duplicate Content",
  "genre": "Test",
  "language": "English",
  "asset_type": "episode",
  "ai_summary": "The asset titled 'Duplicate Content' shows replicated text. It appears to be a test file.\n",
  "ai_keywords": [
    "Duplicate Content",
    "replicated text",
    "test file"
  ],
  "mood": "neutral"
}
2025-07-15 12:40:54,930 - IngestAgent - DEBUG - Thought Chain: Executing Content Normalization step.
2025-07-15 12:40:54,930 - IngestAgent - INFO - Starting content normalization for: another_copy_of_duplicate.mp4
2025-07-15 12:40:54,930 - IngestAgent - DEBUG - Thought Chain: Initiating content normalization for another_copy_of_duplicate.mp4
2025-07-15 12:40:54,930 - IngestAgent - DEBUG - Thought Chain: Determined normalized name: asset_e8d0896b_duplicate_content.mp4. Justification: Standard naming convention applied.
2025-07-15 12:40:54,930 - IngestAgent - INFO - Skipping move for duplicate file another_copy_of_duplicate.mp4. Already processed content.
2025-07-15 12:40:54,931 - IngestAgent - DEBUG - Thought Chain: Not moving duplicate file. Justification: Content hash matches existing processed asset. Content already exists in normalized form.
2025-07-15 12:40:54,931 - IngestAgent - INFO - Content normalization complete for ./ingest_source/another_copy_of_duplicate.mp4.
2025-07-15 12:40:54,931 - IngestAgent - DEBUG - Thought Chain: Content normalization process concluded.
2025-07-15 12:40:54,931 - IngestAgent - INFO - Ingestion pipeline skipped for ./ingest_source/another_copy_of_duplicate.mp4: Duplicate content detected.
2025-07-15 12:40:54,931 - IngestAgent - DEBUG - Thought Chain: Decision - Pipeline terminated due to duplicate content. Justification: Asset content already exists in the system.
2025-07-15 12:40:54,932 - IngestAgent - INFO - Handing off asset to downstream agents: N/A
2025-07-15 12:40:54,932 - IngestAgent - DEBUG - Thought Chain: Initiating hand-off process.
2025-07-15 12:40:54,932 - IngestAgent - INFO - Context Shared (simulated hand-off):
{
  "original_path": "./ingest_source/another_copy_of_duplicate.mp4",
  "ingest_start_time": "2025-07-15T12:40:50.675914",
  "status": "DUPLICATE_SKIPPED",
  "format_valid": true,
  "format_issues": [],
  "transcode_needed": false,
  "initial_transcode_required": false,
  "ffprobe_data": {
    "format": {
      "filename": "another_copy_of_duplicate.mp4",
      "nb_streams": 2,
      "format_name": "mp4",
      "duration": 6.0,
      "size": 10485760
    },
    "streams": [
      {
        "codec_type": "video",
        "codec_name": "h264",
        "width": 1920,
        "height": 1080,
        "avg_frame_rate": "25/1",
        "display_aspect_ratio": "16:9"
      },
      {
        "codec_type": "audio",
        "codec_name": "aac",
        "channels": 2
      }
    ]
  },
  "metadata": {
    "source_file": "another_copy_of_duplicate.mp4",
    "ingest_timestamp": "2025-07-15T12:40:50.703190",
    "checksum_sha256": "eb6183addde05c2196ce25e6fa34a4baf20f9bf30d33892f452a9a1e88c9a472",
    "file_size_bytes": 10485760,
    "duration": 6.0,
    "title": "Duplicate Content",
    "genre": "Test",
    "language": "English",
    "asset_type": "episode",
    "ai_summary": "The asset titled 'Duplicate Content' shows replicated text. It appears to be a test file.\n",
    "ai_keywords": [
      "Duplicate Content",
      "replicated text",
      "test file"
    ],
    "mood": "neutral",
    "normalized_file_path": "DUPLICATE_SKIPPED_MOVE",
    "normalized_file_name": "DUPLICATE_SKIPPED_MOVE"
  }
}
2025-07-15 12:40:54,932 - IngestAgent - DEBUG - Thought Chain: Hand-off completed successfully. Justification: Asset is compliant or issues were handled internally.
2025-07-15 12:40:54,933 - IngestAgent - INFO - Hand-off complete.
